---
slug: from-ibis-to-map
title: "Geospatial Ibis: Exploring Overture Maps with Ibis, DuckDB, and Fused"
authors: [naty]
tags: [introduction]
unlisted: true
image: https://fused-magic.s3.us-west-2.amazonaws.com/blog-assets/social_jennings.png
hide_table_of_contents: false
keywords: [introduction]
---


Naty is a Sr. Software Engineer; contributor to ibis for N years; and renowned for enabling the spatial extension in DuckDB for Ibis.

In this blog post she shows how the uses the DuckDB spatial extension in Ibis to query and aggregate overture data.

{/* truncate */}

### Motivation

An overture is a musical piece at the beginning of an opera or play. Founded in 2022, Overture Maps Foundation is an open data effort to power the current and next-generation of map services and products. Mapping services and application providers can look to Overture for reliable, easy to use, and interoperable open map data. The data is delivered with a documented schema that allows developers to acess it in consistent patterns and conflate it with other spatial data via a unique identifier. In a way, Overture data is becoming a common shared backbone to expand a global catalog of linked data.

Overture's datasets include:
- Buildings: 2.3 billion unique building footprints worldwide
- Places of Interest (POI): 54 million places worldwide
- Divisions: National and regional administrative boundaries.

Overture Maps data is available in cloud-native Parquet format. The data is organized in a way that allows for efficient querying.

The release of `DuckDB 1.1.1` gave Ibis the ability to finally read GeoParquet files. This update enables users to query rich datasets from Overture Maps with python using Ibis and experience the the performance of DuckDB.



### Exploring Overture Maps

read parquet with predicate pushdown. query explain, just bring the relevant data.

### Creating a custom UDF

```python useLineNumbers
@fused.udf
def udf(bbox: fused.types.TileGDF):
    import h3

    conn = fused.utils.common.duckdb_connect()

    # 1. Set H3 resolution
    x, y, z = bbox.iloc[0][["x", "y", "z"]]

    ...
```

### Conclusion

The synergy between Ibis, DuckDB, and Fused expressing queries and performing transformations on geospatial data has never easier.

These frameworks make interacting with geospatial data a breeze.

### Resources


- [Overture Maps Data Repo](https://github.com/OvertureMaps/data)
- [Ibis Docs](https://ibis-project.org/)
- [DuckDB spatial extension](https://duckdb.org/docs/extensions/spatial.html)
- [DuckDB spatial functions docs](https://github.com/duckdb/duckdb_spatial/blob/main/docs/functions.md)
- Chat with Naty on the [Ibis Zulip Chat](https://ibis-project.zulipchat.com/)
