---
slug: from-query-to-map-exploring-geoparquet-overture-maps-with-ibis-duckdb-and-fused
title: "From query to map: Exploring GeoParquet Overture Maps with Ibis, DuckDB, and Fused"
authors: [naty]
tags: [ibis]
unlisted: true
image: https://fused-magic.s3.us-west-2.amazonaws.com/blog-assets/social_jennings.png
hide_table_of_contents: false
keywords: [ibis]
---

Naty is a Senior Software Engineer and a contributor to Ibis, the portable Python dataframe library. One of her main contributions was enabling the DuckDB spatial extension for Ibis in 2023.

In this blog post, she shows us how to leverage the spatial extension in DuckDB with Ibis to query Overture data. Ibis works by compiling Python expressions into SQL, you write Python dataframe-like code, and Ibis takes care of the SQL. Thanks to Ibis integration with pandas and geopandas, you only need to do `to_pandas()` to get your expression as a geopandas dataframe (If Ibis identifies a geometry column it will result in a geopandas dataframe otherwise it will be a pandas one ). If you want to learn more about Ibis geospatial capabilities, check some of the geospatial blog posts here.

{/* truncate */}

### Motivations

Overture maps is emerging as a global backbone for linked spatial data. The Overture Maps Foundation, founded in 2022, is an open data initiative aiming to introduce the foundation for next-generation map services and applications. Overture offers reliable, easy-to-use, and interoperable open map data. Its structured schema enables consistent data access and seamless integration with other spatial data using unique identifiers.


Overture Maps has multiple datasets you can explore and query. Check their documentation guide to find out more about them. In this blog, we will explore the base theme and some of the infrastructure features.

Have you ever been on a walk as a tourist and wondered where you could get public drinking water or a bench to sit, or maybe you need to make a restroom stop, but you don’t know where to find any of these?

We will find out how you can easily get this information from Overture data and visualize it, using Ibis and Fused. You’ll be able to insert an address and see this key information.

## Getting the data

Overture distributes its datasets as GeoParquet, an optimized cloud-native format that enables you to efficiently get chunks of data from the cloud. The release of DuckDB 1.1.1 marked a significant milestone by adding support for GeoParquet files. This update enables users to query rich geospatial datasets, such as Overture Maps. Thanks to the support for  DuckDB geospatial operation in Ibis, we can query the datasets from Overture Maps using python with the performance of DuckDB without having to write SQL. Together, these tools offer an accessible and powerful solution for unlocking insights from global geospatial data.

### Exploring Overture Maps


Using Ibis with DuckDB as the backend, we can access the Overture Maps data directly from the cloud. These queries will only fetch the attributes and rows that meet specified conditions, minimizing the data processed locally.




### Creating a custom UDF


```python useLineNumbers
...
```

### Conclusion

The synergy between Ibis, DuckDB, and Fused has redefined the ease of querying and visualizing geospatial data. These frameworks provide an intuitive and powerful toolkit, enabling users to express geospatial queries, perform efficient transformations, and access high-performance analytics with minimal setup.

By leveraging this stack, interacting with vast geospatial datasets like Overture Maps becomes straightforward, efficient, and accessible.

### Resources

- [Overture Maps Data Repo](https://github.com/OvertureMaps/data)
- [Ibis Docs](https://ibis-project.org/)
- [Ibis - DuckDB geospatial blogs](https://ibis-project.org/posts#category=geospatial)
- [DuckDB spatial extension](https://DuckDB.org/docs/extensions/spatial.html)
- [DuckDB spatial functions docs](https://github.com/DuckDB/DuckDB_spatial/blob/main/docs/functions.md)
- [Ibis Zulip Chat](https://ibis-project.org/posts/ibis-overturemaps/)
