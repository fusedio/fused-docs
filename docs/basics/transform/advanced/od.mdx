# Origin Destination

```python
@fused.udf
def udf(n: int=10, num_points = 20, object_to_return: str = 'points'):
    import geopandas as gpd
    import pandas as pd
    import numpy as np
    import matplotlib.pyplot as plt
    from shapely.geometry import Point, LineString
    import random
    
    # Define the bounding box
    # minx, miny, maxx, maxy = -122.55, 37.70, -122.35, 37.82
    minx, miny, maxx, maxy = -5.97468,35.5492, -5.37391, 35.89908

    # Generate random points within the bounding box
    np.random.seed(1)
    points = np.random.rand(num_points, 2)
    points[:, 0] = points[:, 0] * (maxx - minx) + minx
    points[:, 1] = points[:, 1] * (maxy - miny) + miny
    
    # Create a GeoDataFrame for the points
    gdf_points = gpd.GeoDataFrame({'geometry': [Point(p) for p in points]})

    # Generate random origin-destination pairs with weights
    edges = []
    for _ in range(num_points * 2):  # arbitrary number of edges
        start_idx, end_idx = random.sample(range(num_points), 2)
        start_point = points[start_idx]
        end_point = points[end_idx]
        weight = random.randint(1, 5)
        line = LineString([start_point, end_point])
        edges.append({'geometry': line, 'weight': weight})
    
    # Create a GeoDataFrame for the edges
    gdf_edges = gpd.GeoDataFrame(edges)
    print(gdf_edges)
    if object_to_return == 'points':
        return gdf_points
    else:
        return gdf_edges
```

import Iframe from '@site/src/components/Iframe';


<Iframe url="https://staging.fused.io/workbench#app/s/aH4sIAAAAAAAAA61U227bMAz9FUF7SDK4ievYzgXw04oNGIbtocNe4sKQLdrR4kieJDdNh%2F37KOfWGt0F2GjDIXnII1IE850WigNdUrFtlLak2XMoNoQZ0vBNKo9eYzWwbS2sA4w9%2B8vWAM9Y05w9FaiGSY5h%2BFYNT6V7jB1bYWsYpvTTTUpHB6%2FMGiWkNSRBzrGpBQeNER%2FbbQ6aqJIc4JR6xPfItY%2BfIBp1bDstrGO7XaudkBVxMSc6D61j6vh4llUbkMkgnuXxNI6uAWZhNJ1BmIfA5vM5C4MwjOOIxddxwOMiCKZ5EOYRzEu%2FnM%2BLxTTmkJfhIJW8xGrPbY91K4cduUdU%2FhUKm1mVabCtxuOAV2AGl8KSkzJyPJfm%2F5LuEP8LvlTWsvJIzSwSDq%2BicRzPPTKNxrNwEXT4K%2FIGh2iBbFnT3eFh1FmxZtoOU0lQcObjG3QeTScYnRm7ryFJKeq5elhOJp3DTA72hDO9ubpf4AwuaUIKK1id3QvYYT6emzjyL2jeOuvJCU6wbmFbDgkqXg9Ssjpi2OFz7FGpbbLoORthi3XiP%2FGOnug124M2yaqXg7V9cEivLicpfQfqvVGyC3jW5Uk4syzh5QsIbg7OkyefdQsvwBXYrBYSsp3gdp0MdiCqtX0d%2BP7gd9GFqpVOBqtzeLchZ%2BuunzzqX9F%2Fafe0b38sdBVEbnXdxz9ssn%2F3z3flWPptXswTP7pG1KMavrVCwxawXrpc0fPf1BEDY536wLRme1T2TNf4c1gReudRYd62dX1baABJlyWrDfz4CW6VZnE8BQAA"/>
