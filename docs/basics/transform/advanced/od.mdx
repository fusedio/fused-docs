# Origin Destination

```python
@fused.udf
def udf(n: int=10, n_points = 20, object_to_return: str = 'points'):
    import geopandas as gpd
    import pandas as pd
    import numpy as np
    import matplotlib.pyplot as plt
    from shapely.geometry import Point, LineString
    import random
    
    # Define the bounding box
    # minx, miny, maxx, maxy = -122.55, 37.70, -122.35, 37.82
    minx, miny, maxx, maxy = -5.97468,35.5492, -5.37391, 35.89908

    # Generate random points within the bounding box
    np.random.seed(1)
    points = np.random.rand(n_points, 2)
    points[:, 0] = points[:, 0] * (maxx - minx) + minx
    points[:, 1] = points[:, 1] * (maxy - miny) + miny
    
    # Create a GeoDataFrame for the points
    gdf_points = gpd.GeoDataFrame({'geometry': [Point(p) for p in points]})

    # Generate random origin-destination pairs with weights
    edges = []
    for _ in range(n_points * 2):  # arbitrary number of edges
        start_idx, end_idx = random.sample(range(n_points), 2)
        start_point = points[start_idx]
        end_point = points[end_idx]
        weight = random.randint(1, 5)
        line = LineString([start_point, end_point])
        edges.append({'geometry': line, 'weight': weight})
    
    # Create a GeoDataFrame for the edges
    gdf_edges = gpd.GeoDataFrame(edges)
    print(gdf_edges)
    if object_to_return == 'points':
        return gdf_points
    else:
        return gdf_edges
```

import Iframe from '@site/src/components/Iframe';


<Iframe url="https://staging.fused.io/workbench#app/s/aH4sIAAAAAAAAA61U227bMAz9FUF7SDK4jpct7RJAL22xAMWwPrTYHuLCUC3G0aJIniTXSYf9%2Byg7l9boLsBGGzbJQx6RkunvNDcC6JTKdWmsJ%2BVWQL4i3JFSrFK98zpvga%2BV9AFw%2FuBfVA5Exsvy4CnAlFwLDMO7KEWqw%2BV87KVX0E%2Fp9WVKB61XZ6WR2jvCkDN2SgqwGPGpWt%2BDJWZBWjilEUki8ibBx2g8aNhqK31gu1maWuqChJg9XYTWLjXereXNCjTrLdwyO7tSSX09O%2F%2FCt5vz8YWb1Vej%2FLaXarHAOg4NxbbS%2FSYtIub%2BK%2BQ%2B8yaz4CuLRCAKcL3jkmyvDALPsa2%2FpGvjf8GXaqWLiCjukbB%2FMo5PT99H5O04Pns3GTX4K3KBx%2BOBrHnZ7E57iFm%2B5Nb3U01Q8DTjS3TuzCAYnTm%2FVcBSivq92UyHw8bhhq09FNyuTh4muLvHNKmll1xlDxJqzMd1WSD%2FjOZNsJ6sEATrlr4SwFCJOpDRxQ7DDp9jj8as2aTjLKXPlyx54h080RXfgnVs3snB2j4GpFNXkJTOwFw5o5uAZ13uRXDPmVi8gOBM4HkKdmsreAEuwGdKashqKfyS9WqQxdK%2FHiVJ73fRuVHGst78EN58%2Bwfrrps86G7Rf2l3P0l%2FLHQ%2BGoehDI%2BkndHk7p%2F3KrB02zyae350DWhELXyrpIU1YL10OqeHH9AOA%2BeDuuHW8i0qW24VvtoRoXcRle5DpdRNbgE0nS64cvDjJwx7cbwWBQAA"/>
