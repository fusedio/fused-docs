# Point to H3


```python
@fused.udf
def udf(bbox=None, resolution: int = 9, min_count: int = 10):
    import duckdb
    import shapely
    import geopandas as gpd

    utils = fused.load("https://github.com/fusedio/udfs/tree/f928ee1/public/common/").utils
    h3_utils = fused.load("https://github.com/fusedio/udfs/tree/fb65aff/public/DuckDB_H3_Example/").utils
    con = duckdb.connect(config = {'allow_unsigned_extensions': True})

    h3_utils.load_h3_duckdb(con)
    con.sql(f"""INSTALL httpfs; LOAD httpfs;""")
    
    @fused.cache
    def read_data(url, resolution, min_count):
        df = con.sql("""
        SELECT h3_h3_to_string(h3_latlng_to_cell(pickup_latitude, pickup_longitude, $resolution)) cell_id,
               count(1) cnt
        FROM read_parquet($url) 
        GROUP BY cell_id
        HAVING cnt>$min_count
        """, params={'url': url, 'resolution': resolution, 'min_count': min_count}).df()
        return df

    df = read_data('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2010-01.parquet', resolution, min_count)
    print("number of trips:", df.cnt.sum())
    print(df)
    return df

```


import Iframe from '@site/src/components/Iframe';


<Iframe url="https://staging.fused.io/workbench#app/s/aH4sIAAAAAAAAA1VTDWvbMBD9K0IbNAE3H01CloBhoyV0UMa2rttYFIxinR01suRJcpus9L%2FvZLtuKtvo7t3pnXRPfqKpEUCXVBalsZ6URwHpnnBHSrFnukWdt8ALJX0ION%2FhWeVAJLwsOyQHU3ItMA3fvBRMh8f5gZdeQY%2FRr0ZqT7wh1xNG%2B034HbkxXBDBPSeZNQW5u1qRlCvFtDd70CQmZ5nbJen4152aXP75fL%2F9%2FUXNFvOV0PffzgLFRyyR8nQHSWBhWkBGFJLWbq%2B%2FZJrgEBlSdZse2Er36gL9JmzBV1ZjVmCsc08omFY6j4jiHvHe%2BXwyWHyYzxeziExHg%2FlsOltM%2B81hLrFZHvCAmHwEiwvDhKuwpYObYPeaeoxeT67hwHOja5jR6GWfrVHKdM%2B3CuIftoIWQzFwz%2BIUyqRSbxE4eFsJxFZcuRcwB5%2FsmnoxoykolUjRFQ3RQJSkRhmLCetU%2Bwi%2F4Xg0CvPmTaqSGtrU9cV0FJELbMVo02bU0Ucp%2FC4ppE5KeQDl4jFG2yZ9B9TI1lejuXNJuuPWt50JnbpCsHXDKHiZOH%2FEXjCK9tYclsNhDbhh4w8Ft%2Fvzh%2FG422cYUksvuUoeJDwiASoTB%2Faf6N4Gr4eKSo%2B9itFAfY3OWzfI%2Fc%2BYIh7j6bbArdR5jGYpfbqLL0b9kyq1xC5evyIdGpG34LsGTkqjjqjEa3BzwueNUV6W8ROjHrVkdIm35dNDTlbcAuGFqbRfkvdPGbpJ4z4z%2BtwQ9Nsu04ha%2BFtJCwVo7%2BhyTbv%2Fs42B88E8cGv5EY0jtwqnRhK6iah0q0qp29QCaLrMwm16%2Fg8Nq5nvNQQAAA%3D%3D"/>


