# Raster with polygon (Zonal stats)

```python
@fused.udf
def udf(
    bbox: fused.types.TileGDF, min_zoom=12, table="s3://fused-asset/infra/building_msft_us/", chip_len=256
):
    utils = fused.load("https://github.com/fusedio/udfs/tree/f928ee1/public/common/").utils
   
    # Conditionally run the UDF if zoom level is high enough, to avoid blowing up the memory
    if bbox.z[0] >= min_zoom:

        # Load GeoDataFrame (Vector)
        gdf = utils.table_to_tile(bbox, table, min_zoom)

        # Load DSM array (Raster)
        dsm_to_tile = fused.load("https://github.com/fusedio/udfs/tree/f928ee1/public/DSM_JAXA_Example").utils.dsm_to_tile
        arr = dsm_to_tile(bbox, z_levels=[4, 6, 9, 11], verbose=False)

        # Run zonal statistics
        return utils.geom_stats(gdf, arr, chip_len=chip_len)
    else:
        print("Please zoom more... (US Only)")
```


import Iframe from '@site/src/components/Iframe';


<Iframe url="https://staging.fused.io/workbench#app/s/aH4sIAAAAAAAAA31T227bMAz9FcMD1hVIfMmlsQMYe9ge97ZiL3VhKBLtaJElTaKTukH%2BfXSSrlnQlpJh8hxSpChpH3IjIFyGsrXGYWB7AXwTMB9YsSn1GfXogLVK4kB4LPUwPgXfCEUIWmZL7TE6xVZ8zRx%2BKXVAQotE3wk8m4OQd%2BWxV1CUIekr87SM4yPg45MdC%2BY2421ehqPXMKklSqaqrYQdxVPeYlj8F5k%2FB%2BsiwyCKocROQDFdRItsOpmOrnijm5PDOJ1Motl0Ms%2BvXJ6NaYt0foVaiXxdJBfo7YWuWA%2FOFw9XMVToj4G5KnKQMryXCo7sf%2Ft9EcGQUafWiNYfG8UaqZuo7jyISJrYg9uCi7dpTIehULYw9nQAIOLVKs0W%2FG4ukqSuRUKj5iyBJE2S7C7POc8SkedslbHZKp%2BlaT2bp%2FMZeU0X%2BfQuq2PX6RjlcC7750O8f6KvP3wV2FuoTIeVYx7BFVY3n1%2FBLXA0rmjA%2FPZGv7klK%2FmGregC3LsO3uBrqRSI91i6i2bzPt0AVkpqqLhRVMfNg3XGgkMJPhqujR8FCc3Hm3dih%2BQfxF4g3HQaP1rqWMZOClwXkyuX21fz8UwRRDMchQ7%2BdNJBCxp9uHwIqZWWacH8mQOPg%2FrEnGM9KT1zin6n13dUamV2x1dIVuOYXW%2FlM6n%2FXvGYcQgfD38BVPr89%2FwDAAA%3D"/>