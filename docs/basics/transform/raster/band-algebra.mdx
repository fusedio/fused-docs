# Band algebra

```python
@fused.udf
def udf(
    total_bounds: list = "[-122.6953125, 37.43997405, -122.34375, 37.71859033]",
    chip_len: int = 512,
    band = "B02",
    time_of_interest= "2021-09-01/2021-12-30",
    collection= "sentinel-2-l2a"
):
    import json

    from shapely.geometry import box
    import geopandas as gpd
    import fused
    from utils import create_tiffs_catalog, run_pool_tiffs, search_pc_catalog
    
    bounds = json.loads(total_bounds)
    bbox = gpd.GeoDataFrame(geometry=[box(*bounds)], crs='4326')
    query = {"eo:cloud_cover": {"lt": 5}}

    stac_items = search_pc_catalog(bbox=bbox, time_of_interest=time_of_interest, query=query, collection=collection)
    df_tiff_catalog = create_tiffs_catalog(stac_items, [band])
    arrs_out = run_pool_tiffs(bbox, df_tiff_catalog, chip_len)

    return arrs_out[0][0], bbox

```


import Iframe from '@site/src/components/Iframe';


<Iframe url="https://staging.fused.io/workbench#app/s/aH4sIAAAAAAAAA41V227bOBD9FUL7IHnXka2bZRswsEmLPrZAk5dFZBgUNXIIy6SWpJq4gf%2B9Q1FW07gPFQyLPGfuHA1fPSYr8NYeP7ZSGdKeKmAHQjVpq0MhBlQbBfTYcGMJbUa87jRUO9q2I7IH2VJRoRj%2B9m01Ei9UKXoat1SfBOOyEIX4izxw0wCRNTFPQHprRhra7ErZiUqTDboMDbyYHRdtZwL%2FwbKEH%2BkeiJPxp6TwHm%2BiOA4XqyyJ4mxKkjxMk9UqT%2Be46akkTXJH5NEyW82TZFt4k0JY8zaEoPDuMHhCmz2UivackQcQGELhsWWdpUCzspovFqt0EWVVzViUs7hcQJ1XOYOMZglE5aqu6nzFylVc0nSeZHMax2laeC7br1CDAsFgTZ6MafV6NmsbKsBQdWLyiBmCCo%2BcKallbUKEZhU1VIOZaRCGC2hu4psmpoW4u%2F388R6Dey0Ewcdnkmosjb8m%2Ft088qcDXDYdOCwesb0CEA5MRlBB5aD0LQTVHsIcsZ7KrqmBWVwxy2XiqHykBFcOWl5LL7KeWt6OlH7mKlr0aBT9gsaxQ2O%2FEGdX2C%2Bt4VJoUkvVd5KGBpghzxyNY8%2FKgd6QhmsT9LULD3DSwWTiDHzALjfwO123xV53RnbUNaWDS%2FmCnXPvNKggTobQdeFNh42eEi4qeNksJ9fGyj8wVv7OWDzE%2FZFr7KDTm8ChGmT75n5W3EBQ%2B%2F%2FJbuTX5PUqqTOx3X%2BFl2d%2FcPS1E6Sravf19nWmTUNK1NKF%2BBc9McqeYKdAy04xKDDKGoeEYMFk7c7OynLMDHv27BBr5TDtCUyLuGPBeI96VLKP7KzSMDbCB6oPwTh9QtWJoP9QnZ2N%2FcMl1nLzdpJMiVXffKKNBnvmF9tDUI%2F2vUUv6MuRCkynxIW3NSjEzwxcYq4yt88Up6PNBbAEvQZ2XGd2YzFty9Be6uKuT%2FXx6hS223ea5R9qllbTBvNZqiNt%2BHfsgorXw7Sxh9EYG0XwLq4b8s7dhMyuhP55JzQhf5M4yy4jDY2rvtf6qRz0rtw6%2FEZx%2FOgQJ9OphcDvuDBL%2F1L%2BQnhTT8H%2FHVdwxOmmvfWjN14iAwfa2KW7QnBxoqrBl7urvO3U4%2FpT1zT3zM40b13b8z3%2FAHWNA%2BjaBgAA"/>

{/* <Iframe url="https://staging.fused.io/workbench#app/s/aH4sIAAAAAAAAA61W32%2BjOBD%2BVyz2AbhLSfgVkkiRrr3VPu5J276cShQZPKRWiM3ZZttslf%2F9bMzSNGT39uFo1cL3jWfG840HXp2SE3BWDj00XCjUHAmUe4Qlasg%2BZz0qlQB8qKkyhFQDXrUSyBY3zYDsgDeYEW2mf3cNGYgXLAQ%2B5sz8fEAPVNWAeIXUE6BuveIK19uCt4xItNZBAgUvaktZ0yrPfTAsoge8A2Rt3AnKncebMIqC%2BTKNwyidoDgLkni5zJKZfuioOIkzS2ThIl3O4niTO37OjHuTgpc7dzpdhOsdFAJ3nOJ7YDqF3CkXVZoATgsym8%2BXyTxMSVWWYVZGxRyqjGQlpDiNISyWFamyZVksowInszid4ShKktyxu%2F0CFQhgJazQk1KNXE2nTY0ZKCyOJT%2FoHYIIDrQUXPJKBRqaEqywBDWVwBRlUN9EN3WEc3Z3%2B%2FnjvU7uNWdIX27JsdSlcVfIvZuF7qSHi7oFi0UDthMAzILxAAogFkrOISA7CDKNdVQ6pnpmPmIWi9hS2UAxKiy0GFvP045a3A6UfKYinHdoGL5Do8iikZuzky3sX42inElUcdF1koQaSoWeqXauu5T39BrVVCqvq12wh6P0fN86%2BFP3tYJra%2B2j7m7rZIttU1q44C%2B6c%2B7tCsyQtUF4lTuT%2FkH6xn9%2FHwg48K%2FgjZz640DFLwQqLgKZUB%2Bp1E11PNsLkN6k6%2FdnQRV4lfs3bwd%2BhV5HKZ2QORAjvDi5faAP6DZAX1qGWlLpU35kZVd%2FXNeo0EulsflDByxx%2BQRbAZK3ogSDWmMCFao5JltjvTWN7tH1zF8ZC3MZ%2BCvWDWyEez2N4egdbmLvJx2NKENWZL3Vg1Z58Gku3iq9cBhZgWiZ1511u3ht%2FuhbXfL1%2BTCaIJP1%2BhOuJfjn%2Ft4SetxvtGft%2F0pO20bwA5VgcntbcTXBsx1ajx5%2Bxnrmnrvxg24IBn2BfkNhMPvuYxD5zNGQsQDVivMUIsO8q7WNdiFN1Kt%2B96b5NcmvCX5FaLPhqxpfV%2FgX9P1%2F1H0QrRH3p9KO0vlPaX8o7Pnqq4L%2BSDGD5%2Bxd9S4r%2FP0V2w%2BNXh%2B9g%2B1wpHGfQr%2FF0QjYXNgXP7cvNjbiZy4OuKbfwAhF4MV0QK1MMO8i%2FA268O%2Bj6cjo9wsjXxcnStNumHU18zr3gX4BHhvw3JYytXDNZHcmjoB%2FWqqnrn59Smf16AzfJT0HUplb%2B1Wib45Y1Pqf%2FfxxNhOHyk9tXd%2BX5qXprCpz%2Bk%2F%2FAiLxFxwtCQAA"/> */}

