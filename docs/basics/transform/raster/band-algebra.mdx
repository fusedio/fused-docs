# Band algebra

```python
@fused.udf
def udf(
    total_bounds: list = "[-122.6953125, 37.43997405, -122.34375, 37.71859033]",
    chip_len: int = 512,
    band = "B02",
    time_of_interest= "2021-09-01/2021-12-30",
    collection= "sentinel-2-l2a"
):
    import json

    from shapely.geometry import box
    import geopandas as gpd
    import fused
    from utils import create_tiffs_catalog, run_pool_tiffs, search_pc_catalog
    
    bounds = json.loads(total_bounds)
    bbox = gpd.GeoDataFrame(geometry=[box(*bounds)], crs='4326')
    query = {"eo:cloud_cover": {"lt": 5}}

    stac_items = search_pc_catalog(bbox=bbox, time_of_interest=time_of_interest, query=query, collection=collection)
    df_tiff_catalog = create_tiffs_catalog(stac_items, [band])
    arrs_out = run_pool_tiffs(bbox, df_tiff_catalog, chip_len)

    return arrs_out[0][0], bbox

```


import Iframe from '@site/src/components/Iframe';


<Iframe url="https://staging.fused.io/workbench#app/s/aH4sIAAAAAAAAA41VXY%2FiNhT9K1b6kNBCIAkhgITUma72cSvtzEs1QchxbsAi2Knt7Aw74r%2F3Og7ZWejDRojY59xv31y%2Fe0yW4K09fmqkMqQ5l8COhGrSlMdc9Kg2Cuip5sYS2gx41Wood7RpBmQPsqGiRDH87ZtyIN6oUvQ8bKk%2BC8ZlLnLxG3nmpgYiK2IOQDprRhpa7wrZilKTDboMDbyZHRdNawL%2F2bKEn%2BgeiJPxxyT3XiZRHIeLVZpEcTomSRbOk9Uqm89w01HJPMkckUXLdDVLkm3ujXJhzdsQgtx7xOAJrfdQKNpxRh5BYAi5x5ZVOgeaFuVssVjNF1FaVoxFGYuLBVRZmTFIaZpAVKyqsspWrFjFBZ3PknRG43g%2Bzz2X7VeoQIFgsCYHYxq9nk6bmgowVJ2ZPGGGoMITZ0pqWZkQoWlJDdVgphqE4QLqSTypY5qLx4cvn54wuPdcEHx8JqnG0vhr4j%2FOIn%2Fcw0XdgsPiAdsrAOHAZAAVlA6af4Sg3EOYIdZR6T3VM4s7ZrlMHJUNlODKQct76UXaUcuHgdKvXEWLDo2in9A4dmjs5%2BLiCvt3Y7gUmlRSdZ2koQZmyCtH49izsqc3pObaBF3twiOcdTAaOQN%2FYZcb%2BD9dt8Ved0Z21DWlgwv5hp3z5DSoIE6G0HXujfuNHt3bKH7BRnFjw0b5iWvsl%2FOHMKHsRbpWflXcQFD5%2F8h24Nfk%2FS6FC7G9focXF7939LUVpC0r9612VaV1TQrU0rn4Ez0xyg6wU6BlqxjkooQKR4JgwWjtTsrKckwIO%2FTiEGvlOO4IwgVxh4DxnvSgZB%2FZWqV%2BSITPVB%2BDYdaEqhVB91k6Oxv7h0ss4ebj3BgTq775TGsN9oSvtvugXux7i17QlyMVmFaJK29rkIsfGbjEXGUeXinOQpsLYAk6Deyv1uyGYtoGoZ3U1V2X6svdKWy3N5rFL2oWVtMG80WqE635d%2ByCklf9bLGHURsbRXAT14TcuBuR6Z3QHzdCI%2FI7idP0OsDQuOp6rZvBQefKrcNvFIeNDnEOnRsI%2FJYLs%2FSv5c%2BFN%2FYU%2FNtyBSecZdpbv3jDldFzoI1dugsDF2eqany5m6lbVLV8ZQeqDO72ijaHb%2Fw7LodbakIZeNuxx%2FXntq6fmB113rqyjXD5D%2BH2%2FH3xBgAA"/>

{/* <Iframe url="https://staging.fused.io/workbench#app/s/aH4sIAAAAAAAAA61W32%2BjOBD%2BVyz2AbhLSfgVkkiRrr3VPu5J276cShQZPKRWiM3ZZttslf%2F9bMzSNGT39uFo1cL3jWfG840HXp2SE3BWDj00XCjUHAmUe4Qlasg%2BZz0qlQB8qKkyhFQDXrUSyBY3zYDsgDeYEW2mf3cNGYgXLAQ%2B5sz8fEAPVNWAeIXUE6BuveIK19uCt4xItNZBAgUvaktZ0yrPfTAsoge8A2Rt3AnKncebMIqC%2BTKNwyidoDgLkni5zJKZfuioOIkzS2ThIl3O4niTO37OjHuTgpc7dzpdhOsdFAJ3nOJ7YDqF3CkXVZoATgsym8%2BXyTxMSVWWYVZGxRyqjGQlpDiNISyWFamyZVksowInszid4ShKktyxu%2F0CFQhgJazQk1KNXE2nTY0ZKCyOJT%2FoHYIIDrQUXPJKBRqaEqywBDWVwBRlUN9EN3WEc3Z3%2B%2FnjvU7uNWdIX27JsdSlcVfIvZuF7qSHi7oFi0UDthMAzILxAAogFkrOISA7CDKNdVQ6pnpmPmIWi9hS2UAxKiy0GFvP045a3A6UfKYinHdoGL5Do8iikZuzky3sX42inElUcdF1koQaSoWeqXauu5T39BrVVCqvq12wh6P0fN86%2BFP3tYJra%2B2j7m7rZIttU1q44C%2B6c%2B7tCsyQtUF4lTuT%2FkH6xn9%2FHwg48K%2FgjZz640DFLwQqLgKZUB%2Bp1E11PNsLkN6k6%2FdnQRV4lfs3bwd%2BhV5HKZ2QORAjvDi5faAP6DZAX1qGWlLpU35kZVd%2FXNeo0EulsflDByxx%2BQRbAZK3ogSDWmMCFao5JltjvTWN7tH1zF8ZC3MZ%2BCvWDWyEez2N4egdbmLvJx2NKENWZL3Vg1Z58Gku3iq9cBhZgWiZ1511u3ht%2FuhbXfL1%2BTCaIJP1%2BhOuJfjn%2Ft4SetxvtGft%2F0pO20bwA5VgcntbcTXBsx1ajx5%2Bxnrmnrvxg24IBn2BfkNhMPvuYxD5zNGQsQDVivMUIsO8q7WNdiFN1Kt%2B96b5NcmvCX5FaLPhqxpfV%2FgX9P1%2F1H0QrRH3p9KO0vlPaX8o7Pnqq4L%2BSDGD5%2Bxd9S4r%2FP0V2w%2BNXh%2B9g%2B1wpHGfQr%2FF0QjYXNgXP7cvNjbiZy4OuKbfwAhF4MV0QK1MMO8i%2FA268O%2Bj6cjo9wsjXxcnStNumHU18zr3gX4BHhvw3JYytXDNZHcmjoB%2FWqqnrn59Smf16AzfJT0HUplb%2B1Wib45Y1Pqf%2FfxxNhOHyk9tXd%2BX5qXprCpz%2Bk%2F%2FAiLxFxwtCQAA"/> */}

