# Vectorize

```python
@fused.udf
def udf(
    threshold: int=100,
    cog_url = "https://eodata.sage.uvt.ro/copernicus-dem/copernicus-dem-30m/Copernicus_DSM_COG_10_N37_00_W123_00_DEM/Copernicus_DSM_COG_10_N37_00_W123_00_DEM.tif"
):
    import geopandas as gpd
    import rasterio
    import shapely
    from rasterio.features import shapes

    with rasterio.open(cog_url) as src:
        arr = src.read()
        bounds = src.bounds
        transform = src.transform
        crs = src.crs
    arr = (arr > threshold).astype("uint8")
    shapes_list = list(shapes(arr, mask=None, transform=transform))
    geoms = [shapely.geometry.shape(i[0]) for i in shapes_list]
    gdf = gpd.GeoDataFrame(
        shapes_list, geometry=geoms, columns=["geometry", "value"], crs=crs
    )
    return gdf[gdf.value == 1]
```



import Iframe from '@site/src/components/Iframe';


<Iframe url="https://staging.fused.io/workbench#app/s/aH4sIAAAAAAAAA31T34%2BbMAz%2BV1D20kqU8qMUqMTTpk2a9nanezlOVSCmRE0TlqTttdP%2B9xnacj10N4OC%2Fdmf4xjnD6kUA7IifNcqbZ32xKDaOtQ4LdsW8ooaq4HuBLedw9gBr%2FcG2Jq27YBsQLVUMgzDd9OyQnaPsZ7lVsCkIE9QWaX5GQoyvThto8E0SjAnx9yeEZyBxsjHG14Q1%2FFdJ%2FB9XMPYv%2FHUFiRyCsJKlvhZFad1wNIwLUt%2FWUd1FUdZFmTLKAt8hs6Ylou4XGZhGWdpgJSUJmlNFxEtSCFZjamG83h6Lyf9Bq4z1JcP2rUCITeuI6hF5iwIQ28RBWGWuE6UeEkSZUnYBX1xvmLzLDg72vaduLR4XTVU20khHRTstfcNwavZCUavjT0JyAuCeqleV%2FN5D5j5xZ4zqrezQ4bteaNxyS2nYn3gcEQ%2B7pt3yZ%2FQfOisux06weK53TPIUXFHLiU3Vx8e873vrNQuT0dgy23V5P4dOr3TBT2BNvnziIO1%2Feo8o7o6KcgPUD%2BNkn3Au1PehFFLc1Z%2F4NmAXddciHWlhNL5cxjH3ezgv%2Bkn6eUTiuASRpRuuQzfRyS8GTglLH%2FUe%2FhfziNntskxyyho%2Bmbe0iM0JS7R8HvPNexAWkNWz2S4WVcfGNupr1RrekLlRLXAz2W6eqUW6thPGVobTdvmwM%2BoDpd5RisgLy7h5vteiIdKA0iyqqkw8PcfQKiwxRgEAAA%3D"/>


