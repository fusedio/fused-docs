# Buffer

```python
@fused.udf
def udf(n_points: int=10000, buffer: int=0.025):
    import geopandas as gpd
    from shapely.geometry import Point, Polygon
    import random


    # Create a GeoDataFrame for points within the bounding box of an outer square
    gdf_polygon = gpd.GeoDataFrame({'geometry': [Polygon([(-122.52690000000051, 37.70313158980733),(-122.52690000000051, 37.816395657523195),(-122.34604834372873, 37.816134829424335),(-122.34656848822227, 37.70339041384273)])]})
    minx, miny, maxx, maxy = gdf_polygon.bounds.iloc[0]
    points = [Point(random.uniform(minx, maxx), random.uniform(miny, maxy)) for _ in range(n_points)]
    gdf_points = gpd.GeoDataFrame({'geometry': points})
    gdf_points['color'] = 10

    # Create a buffer around a point at the centroid of the square
    buffered_polygon = gdf_polygon.centroid.buffer(buffer)

    # Color the points that fall within the buffered polygon
    points_within = gdf_points[gdf_points.geometry.within(buffered_polygon.unary_union)]
    gdf_points.loc[points_within.index, 'color'] = 1000

    return gdf_points
```

import Iframe from "@site/src/components/Iframe";

<Iframe
  id="buffer"
  url="https://staging.fused.io/workbench#app/s/aH4sIAAAAAAAAA31UW2%2FTMBT%2BK5Z52IqyNpdmXStFQjCBhBAPDHhZpsiJj1urrh1sZ1uH%2BO%2BcxF3bVYPTKufynWt8nN%2B0MRzogspNa6wn7ZZDsybMkZavS72zOm%2BBbZT0PeD83i46B7xibVvq%2FveG3CjJwZIHyZfgXal11RqpvSMFho3dgJ6X9Gu3qdHNCBLgRUkjEkckiZECG5W67oRAr5eh7wdjCBjHwyMfnmk%2BCj186zT5cf2x1O8wrmHNCirOPCs1B0GUYXxQz59bK5KhZihWhESLUhMkLrD4fsax7fR5AHoq6fSy5tN8xjkXdTOd8ZpzxmZxxtLLOOPzHER8CTznUz5vplktrtI0n%2BVXLEvm6TzPeT%2FDId%2B%2Bn2fhGNx1F1gwjwKz4DursVWcr2%2F3lQEPCV%2Bk2b2uD3i0HsiG4SHiCwsLUDUrZv1uWtyE8TUaj4ZH78r5rYKipCjX5nExmQwGNwn6hDO7vrif45CHMKmll0xV9xIeMB7rFn3yn6je9NpRhZ4U89J3HIpsNp5dZWkWneBGL4PDRZKm42mW5vMTlydjNkWSnFhb6ZtVER9ZR0eyYluwrrg9icFGv%2FTISZNhFz6B%2BeyMHhxejPxM%2FZEUXLyCCKkU8OK77eAVFK%2BeWf8bxmtWKamhaowytji7xW1%2BO8gR2bEkvjv7XyReVr8q0jg%2BcRod1Ltov3P4pxG18KuTFjaAa0UXt3QJpmWaM7fDwPlefGTWsi0KW2YVsrBcgyCUeRiWDLWlZe3qXj6huP%2FSXLAG6F1EpfvYKXXTWABNF4IpB3%2F%2BArQGTYW1BAAA"
/>
