---
id: load-export-data
title: Load & Export Data
sidebar_label: Load & Export Data
sidebar_position: 0
---

# Load & Export Data 

A set of common examples on how to load and save data in Fused.

## Load Data

### `pandas`

```python
@fused.udf
def udf(path: str = "s3://my-bucket/data.csv"):
    import pandas as pd
    
    return pd.read_csv(path)
```

### `duckdb`

```python
@fused.udf
def udf(path: str = "s3://my-bucket/large_dataset.parquet"):
    import duckdb
    
    conn = duckdb.connect()
    result = conn.execute(f"""
        SELECT * 
        FROM '{path}'
        LIMIT 100
    """).df()
    
    return result
```

### From other UDFs

{/* TODO: Use a non geo example here */}

```python
@fused.udf
def udf(bounds: fused.types.Bounds):
    overture_udf = fused.load('https://github.com/fusedio/udfs/tree/main/public/Overture_Maps_Example/')
    buildings = fused.run(overture_udf, bounds=bounds, theme='buildings', overture_type='building')
 
    return buildings
```

## Export Data

### Fused managed storage

```python
# Save to Fused managed S3 bucket
df.to_parquet("fd://my-dataset/data.parquet")
```

### AWS S3

```python
# Save to your own S3 bucket
df.to_parquet("s3://my-bucket/data.parquet")
```

### Google Cloud Storage

```python
# Save to Google Cloud Storage
df.to_parquet("gcs://my-bucket/data.parquet")
```

### Use as API (No file saving required)

You can change the output format of your HTTPS endpoint:

```bash
https://fused.io/.../run/file?dtype_out_vector=json
```

**Tabular data downloads:**

```bash
# ?dtype_out_vector=csv          # CSV download
# ?dtype_out_vector=geojson      # GeoJSON download  
# ?dtype_out_vector=parquet      # Parquet download
# ?dtype_out_vector=json         # JSON download
# ?dtype_out_vector=mvt          # Mapbox Vector Tile download
```

**Image data downloads:**

```bash
# Add to your UDF endpoint URL:
# ?dtype_out_raster=png          # PNG image
# ?dtype_out_raster=tiff         # GeoTIFF download
```

### Integrate with Other Tools

{/* TODO: Need to clean this part up */}

**DuckDB:** Connect directly to your UDF endpoint

**Curl:** Use HTTPS endpoint for command-line access

**Google Sheets:** Connect via UDF API endpoint

**Notion:** Use `/embed` block with UDF endpoint


## Geospatial Data

### `geopandas`

```python
@fused.udf
def udf(path: str = "s3://my-bucket/boundaries.geojson"):
    import geopandas as gpd
    
    return gpd.read_file(path)
```

### `xarray`

```python
@fused.udf
def udf():
    import xarray as xr
    
    # Climate/weather data
    ds = xr.open_dataset('s3://bucket/climate_data.nc')
    
    # Convert to DataFrame
    df = ds.to_dataframe().reset_index()
    
    return df
```

### STAC Catalog (Satellite Imagery)

{/* TODO: This isn't working just yet, need to fix */}

```python
@fused.udf
def udf(bounds: fused.types.Bounds = [-1.631, 48.541, -1.324, 48.724]):
    import pystac_client
    import rasterio
    
    catalog = pystac_client.Client.open('https://earth-search.aws.element84.com/v1')
    
    search = catalog.search(
       bbox=bounds,
       collections=['sentinel-2-l2a'],
       datetime='2025-01-01/2025-01-10',
       query={'eo:cloud_cover': {'lt': 50}},
       sortby=[{'field': 'properties.datetime', 'direction': 'desc'}],
       limit=1
    )
    
    items = list(search.items())
    print(len(items))
    if items:
       item = items[0]
       with rasterio.open(item.assets['red'].href) as src:
           return src.read(1), src.bounds
    
    return None
```