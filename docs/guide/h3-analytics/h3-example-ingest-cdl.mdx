---
id: h3-example-ingest-cdl
title: Example — Ingest CDL
sidebar_label: Example — Ingest CDL
sidebar_position: 11
---

# Example: Ingest CDL (Cropland Data Layer)

[USDA Cropland Data Layer](https://www.nass.usda.gov/Research_and_Science/Cropland/SARS1a.php) (CDL) is categorical land cover. Ingest with `metrics=["cnt"]` so each hex has counts per crop class.

## Ingest

See [Raster to H3 — Example: CDL](/guide/h3-analytics/raster-to-h3#example-cdl-cropland-data-layer). Use a single-year GeoTIFF (e.g. `2024_30m_cdls.tif`) and `run_ingest_raster_to_h3(..., metrics=["cnt"])`.

## Read and filter by crop

Read by bounds and resolution; filter to one crop class with `value` (e.g. 1 = Corn, 206 = Carrots):

```python
@fused.udf
def udf(
    bounds: fused.types.Bounds = [-74.556, 40.400, -73.374, 41.029],
    res: int = None,
    value: int = 206,  # Carrots
):
    path = "s3://fused-asset/hex/CDL/release=2026-01-06/year=2021/"
    hex_reader = fused.load("https://github.com/fusedio/udfs/tree/f2b3909/community/joris/Read_H3_dataset/")
    df = hex_reader.read_h3_dataset(path, bounds, res=res, value=value)
    return df
```

Use in [Aggregations](/guide/h3-analytics/aggregations) (e.g. area share per hex) or [Joining](/guide/h3-analytics/joining) with other env layers.
