---
sidebar_label: Udf (class)
title: Udf (class)
toc_max_heading_level: 2
sidebar_position: 0
---

```python
class Udf
```

A Fused UDF (User-Defined Function) is a callable Python function that runs on Fused infrastructure.

The `Udf` class is the object returned when decorating a function with [`@fused.udf`](/python-sdk/api-reference/fused-udf), or when loading a saved UDF with [`fused.load()`](/python-sdk/api-reference/fused-load).

**Calling a UDF**

UDFs are callable objects. Call them directly like regular Python functions:

```python
@fused.udf
def my_udf(x: int, multiplier: int = 2):
    return x * multiplier

# Call directly
result = my_udf(x=5, multiplier=3)  # Returns 15

# Run locally
result = my_udf(x=5, engine="local")

# Run on a batch instance
result = my_udf(x=5, engine="medium")
```

**Parallel execution**

Use `.map()` to run a UDF in parallel across multiple inputs:

```python
@fused.udf
def my_udf(x: int):
    return x * 2

pool = my_udf.map([1, 2, 3, 4, 5])
df = pool.collect()  # Returns DataFrame with results
```

---

## \_\_call\_\_

```python
udf(
    *args,
    engine=None,
    cache_max_age=None,
    max_retry=2,
    cache=True,
    **kwargs
)
```

Call the UDF to execute it.

**Parameters:**

- **\*args** – Positional arguments to pass to the UDF.
- **engine** (`str | None`) – Execution engine:
  - `"remote"`: Run remotely on a realtime instance. (Default)
  - `"local"`: Run locally.
  - `"small"`, `"medium"`, `"large"`: Run on a batch instance.
- **cache_max_age** (`str | None`) – Maximum cache age. Units: `s`, `m`, `h`, `d`. Example: `"48h"`.
- **cache** (`bool`) – Set to `False` to disable caching. Default: `True`.
- **max_retry** (`int`) – Max retries for failed jobs. Default: `2`.
- **\*\*kwargs** – Keyword arguments to pass to the UDF.

**Returns:** The result of the UDF execution.

---

## map

```python
udf.map(
    arg_list,
    *,
    engine=None,
    cache_max_age=None,
    max_workers=None,
    worker_concurrency=None,
    cache=True,
    max_retry=2,
) -> JobPool
```

Run the UDF in parallel for each element in `arg_list`.

**Parameters:**

- **arg_list** (`list`) – Arguments for each job. Can be a list of values or list of dicts.
- **engine** (`str | None`) – Execution engine (`"remote"`, `"local"`, `"small"`, `"medium"`, `"large"`).
- **max_workers** (`int | None`) – Maximum parallel workers. Default: 32 (remote), 1 (local/batch).
- **worker_concurrency** (`int | None`) – Concurrency per worker.
- **cache_max_age** (`str | None`) – Maximum cache age.
- **cache** (`bool`) – Set to `False` to disable caching.
- **max_retry** (`int`) – Max retries for failed jobs. Default: `2`.

**Returns:** [`JobPool`](/python-sdk/api-reference/jobpool) – Call `.collect()` to get results.

**Example:**

```python
@fused.udf
def process(city: str, year: int):
    return f"{city}-{year}"

pool = process.map([
    {"city": "NYC", "year": 2023},
    {"city": "LA", "year": 2024},
])
df = pool.collect()
```

---

## map_async

```python
async udf.map_async(
    arg_list,
    *,
    engine=None,
    max_workers=None,
    cache_max_age=None,
    cache=True,
    max_retry=2,
) -> JobPool
```

Async version of `map()`. Batch instance types not supported.

---

## name

The name of the UDF. Defaults to the function name.

---

## code

The source code of the UDF as a string.

---

## metadata

Optional dictionary of metadata associated with the UDF.

---

## parameters

Dictionary of default parameters for the UDF.

---

## cache_max_age

Maximum cache age in seconds. `None` for default caching behavior.

---

## instance_type

Default instance type for remote execution (`"realtime"`, `"small"`, `"medium"`, `"large"`).

---

## disk_size_gb

Disk size in GB for batch execution.

---

## region

AWS region for execution.

---

## entrypoint

The name of the entrypoint function within the UDF code.

---

## catalog_url

Returns the URL to open this UDF in Workbench, or `None` if not saved.

```python
udf = fused.load("my_udf")
print(udf.catalog_url)
# https://www.fused.io/workbench/catalog/my_udf-abc123
```

---

## collection_id

The ID of the collection this UDF belongs to.

---

## collection_name

The name of the collection this UDF belongs to.

---

## to_fused

```python
udf.to_fused(*, overwrite=None, collection_name=None)
```

Save this UDF to the Fused service.

**Parameters:**

- **overwrite** (`bool | None`) – If `True`, overwrite existing remote UDF.
- **collection_name** (`str | None`) – Collection to save to. Defaults to `"default"`.

---

## to_directory

```python
udf.to_directory(where=None, *, overwrite=False)
```

Write the UDF to disk as a directory.

**Parameters:**

- **where** (`str | Path | None`) – Directory path. Defaults to UDF name.
- **overwrite** (`bool`) – Allow overwriting.

---

## to_file

```python
udf.to_file(where, *, overwrite=False)
```

Write the UDF to disk as a zip file.

---

## delete_saved

```python
udf.delete_saved(inplace=True)
```

Delete this UDF from the Fused service.

---

## delete_cache

```python
udf.delete_cache()
```

Delete cached results for this UDF.

---

## create_access_token

```python
udf.create_access_token(
    *,
    client_id=None,
    public_read=None,
    access_scope=None,
    cache=True,
    metadata_json=None,
    enabled=True,
) -> UdfAccessToken
```

Create an access token for sharing this UDF.

---

## get_access_tokens

```python
udf.get_access_tokens() -> UdfAccessTokenList
```

Get all access tokens for this UDF.

---

## get_access_token

```python
udf.get_access_token() -> UdfAccessToken | None
```

Get the first access token, or `None`.

---

## shared_url

```python
udf.shared_url(format=None) -> str | None
```

Get the shared URL for this UDF.

---

## schedule

```python
udf.schedule(
    minute,
    hour,
    day_of_month=None,
    month=None,
    day_of_week=None,
    udf_args=None,
    enabled=True,
) -> CronJob
```

Schedule this UDF to run on a cron schedule.

**Parameters:**

- **minute** (`list[int] | int`) – Minute(s) to run (0-59).
- **hour** (`list[int] | int`) – Hour(s) to run (0-23).
- **day_of_month** (`list[int] | int | None`) – Day(s) of month (1-31).
- **month** (`list[int] | int | None`) – Month(s) (1-12).
- **day_of_week** (`list[int] | int | None`) – Day(s) of week (0-6, 0=Sunday).
- **udf_args** (`dict[str, Any] | None`) – Arguments to pass to the UDF.
- **enabled** (`bool`) – Whether the schedule is active.

**Example:**

```python
# Run every day at 8:00 AM
udf.schedule(minute=0, hour=8)
```

---

## get_schedule

```python
udf.get_schedule() -> CronJobSequence
```

Retrieve scheduled runs of this UDF.

---

## render

```python
udf.render()
```

Render the UDF code in a Jupyter notebook cell.

---

## from_gist

```python
@classmethod
Udf.from_gist(gist_id: str) -> Udf
```

Create a UDF from a GitHub gist.
