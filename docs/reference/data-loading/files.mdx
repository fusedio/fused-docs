---
title: File Formats
sidebar_label: Files
sidebar_position: 2
description: Code snippets for loading Parquet, CSV, GeoJSON, Shapefile, COG
---

# File Format Snippets

Copy-paste code for loading common file formats.

## Tabular Data

### CSV

```python
import pandas as pd
df = pd.read_csv("s3://bucket/file.csv")
```

### Parquet

```python
import pandas as pd
df = pd.read_parquet("s3://bucket/file.parquet")
```

### Excel

```python
import pandas as pd
df = pd.read_excel("s3://bucket/file.xlsx")
```

---

## Vector Geospatial

### GeoJSON

```python
import geopandas as gpd
gdf = gpd.read_file("s3://bucket/file.geojson")
```

### Shapefile

```python
import geopandas as gpd
gdf = gpd.read_file("s3://bucket/file.shp")
```

### GeoPackage

```python
import geopandas as gpd
gdf = gpd.read_file("s3://bucket/file.gpkg")
```

### GeoParquet

```python
import geopandas as gpd
gdf = gpd.read_parquet("s3://bucket/file.parquet")
```

### KML/KMZ

```python
import geopandas as gpd
gdf = gpd.read_file("s3://bucket/file.kml")
```

### CSV with Coordinates â†’ GeoDataFrame

```python
import pandas as pd
import geopandas as gpd

df = pd.read_csv("s3://bucket/file.csv")
gdf = gpd.GeoDataFrame(
    df, 
    geometry=gpd.points_from_xy(df.longitude, df.latitude),
    crs=4326
)
```

---

## Raster Data

### GeoTIFF

```python
import rasterio

with rasterio.open("s3://bucket/file.tif") as src:
    data = src.read()
    bounds = src.bounds
```

### Cloud Optimized GeoTIFF (COG)

```python
common = fused.load("https://github.com/fusedio/udfs/tree/main/public/common/")

# Read subset based on bounds
arr, color_map = common.read_tiff(bounds, "s3://bucket/file.tif")
```

### NetCDF

```python
import xarray as xr

# Download first for NetCDF
path = fused.download("s3://bucket/file.nc", "file.nc")
ds = xr.open_dataset(path)
```

---

## DuckDB Queries

### Query Parquet

```python
import duckdb
conn = duckdb.connect()
df = conn.execute("SELECT * FROM 's3://bucket/file.parquet' LIMIT 100").df()
```

### Query CSV

```python
import duckdb
conn = duckdb.connect()
df = conn.execute("SELECT * FROM 's3://bucket/file.csv' LIMIT 100").df()
```

### With Spatial + H3 Extensions

```python
common = fused.load("https://github.com/fusedio/udfs/tree/main/public/common/")
conn = common.duckdb_connect()  # Loads H3 + spatial extensions

df = conn.execute("""
    SELECT h3_latlng_to_cell(lat, lng, 9) as hex, count(*) as cnt 
    FROM 's3://bucket/points.parquet' 
    GROUP BY 1
""").df()
```

