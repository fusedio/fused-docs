---
slug: realtime-data-processing
title: Realtime data processing
---

# Realtime data processing

{/* TODO
- Link to open canvas directly
- Make embeded Canvas larger 
 */}

This tutorial will show you how to build this dashboard processing all of the USDA Crop Data Layer for a year in realtime:

<iframe 
    style={{
        width: "100%",
        height: "600px",
        minHeight: "500px",
        margin: "0 auto",
        display: "block",
        border: "1px solid #e1e5e9",
        borderRadius: "8px"
    }}
    src="https://unstable.fused.io/canvas/fc_2Q5aNgJzLTagImf6MOdWTG" 
    title="Fused Canvas - Realtime Data Processing Dashboard" 
    frameBorder="0" 
    allowFullScreen
    allow="fullscreen">
</iframe>

### Getting Data

Data comes from [Source Cooperative](https://source.coop/fused/hex), based on the 2024 USDA Crop Data Layer. Fused [repartitioned this into H3 hexagons](https://docs.fused.io/blog/cdl-census-hex) and made it available on [Source Cooperative](https://source.coop/fused/hex) for anyone to access.

We'll visualize the 2024 `hex8` data as a parquet file:

```bash
https://source.coop/fused/hex/release_2025_04_beta/cdl/hex8_2024.parquet
```

This has aggregated the data by `hex8` and has the following columns:

| column | description |
|--------|-------------|
| `value` | USDA Crop Data Layer classification code (e.g., 141, 176, 152, 142, 190) |
| `area` | Area in square meters for each crop type within the hex cell |
| `hex` | H3 hexagon identifier at resolution 8 |

### Processing Data with DuckDB

Before we display the data we want to:
- Remove any nodata (`0`) in cdl
- Calculate the percentage that each crop type makes up of the total area of each hex8 cell 
- Return `lat / lon` coordinates for each hex8 cell to be able to display the data on a map

We can write a simple [Fused UDF](/core-concepts/write) to do this for us:

{/* TODO: Add code here + explain a bit what this does */}

This returns directly a dataframe. We can then pass this data directly to another UDF to render this data on a map

### Live filtering on Map

We wrote a custom UDF that takes this data and allows to filter it based on crop type ID:

{/* TODO: Add code here + explain a bit what this does */}

This map is custom to the data we're visualizing but thanks to the [AI Assistant](/workbench/udf-builder/ai-assistant) you can easily adapt this to any data of your choice!

### Building this yourself


