---
slug: pdf-scaping
title: "Search PDFs, Turn Tables into DataFrames"
---

This tutorial will show you how to:
- Search for PDFs online directly in Fused
- Turn tables in PDFs into DataFrames

<div style={{textAlign: 'center'}}>
<img 
src="/img/tutorials/data-science-ai/pdf_next_to_workbench_table.png"
alt="PDF next to table" style={{width: 1200}} />
</div>

_Left: Original PDF. Right: DataFrame of PDF in Workbench_


## Getting Started

As of writing this Search in the [AI Assistant](https://www.fused.io/workbench/ai-assistant) is still under experimental flag so turn it on:
- Go to the [Preferences](/workbench/preferences/)
- Turn on "AI Dataset Search"

{/* ![AI Search Flag in Preferences](/img/tutorials/ai_search_flag.png) */}

## Searching for PDFs

Now that you have AI Search turned on, you can search for PDFs directly in Fused:

```text
Search for any PDFs from Census data that would provide me health insurance coverage & type by age. 
I want the data to be available in a table format.
```

The AI Assistant will provide a list of links to PDFs that are as close to your request as possible:

<div style={{textAlign: 'center'}}>
<img 
src="/img/tutorials/data-science-ai/pdf_search_ai.png"
alt="AI Assistant searching for PDFs" style={{width: 1200}} />
</div>

In it's current stage we recommend you explore the PDFs for yourself to see which one matches your request best.

The first link, pointing to [Census `.gov` data](https://www2.census.gov/library/publications/2024/demo/p60-284.pdf) seems to match our request. Opening it and going to the Appendix we find what we're looking for:

<div style={{textAlign: 'center'}}>
<img 
src="/img/tutorials/data-science-ai/census_table_data.png"
alt="Census table data" style={{width: 1200}} />
</div>

## Turning PDF Tables in DataFrames

Next:
- Use the [Datalab](https://www.datalab.to/) API to turn a [PDF into a JSON](https://documentation.datalab.to/docs/recipes/table-recognition/table-rec-api-overview)
- Write a UDF that turns the JSON into a DataFrame

### Using a preexisting UDF

We [built a UDF](https://www.fused.io/workbench/udf/catalog/datalab_pdf_to_json_to_df-50eb6624-16b9-4347-9170-3a462b264357) on top of the Datalab API that you can directly use:

```python
# in a notebook
import fused

df = fused.run(
    "fsh_5FVJ7x6aOnF92Zd0zOI5IF"m
    pdf_url="https://www2.census.gov/library/publications/2024/demo/p60-284.pdf",
    raw_table_idx=0
)

print(df)
```

This will _not_ return the table we're looking for. This is a simple UDF that returns each table found in the JSON from DataLab as a DataFrame

The print message will however show us all the available tables found:

```

--- Raw Table 0 ------------------------------------------------
Shape: (14, 5)
          Unnamed: 0   2022     2022.1   2023     2023.1
       Coverage type    NaN  Margin of    NaN  Margin of
                 NaN Number error1 (±) Number error1 (±)
               Total 330000        130 331700        145
     Any health plan 304000        746 305200        704
Any private plan2, 3 216500       1399 216800       1294
------------------------------------------------------------

--- Raw Table 1 ------------------------------------------------
Shape: (35, 10)
    Unnamed: 0  Total              Total.1              Total.2              Total.3              Total.4              Total.5              Total.6     Total.7 Unnamed: 9
           NaN    NaN Any health insurance Any health insurance Any health insurance Any health insurance Any health insurance Any health insurance         NaN        NaN
Characteristic    NaN                  NaN                  NaN                  NaN       Private health                  NaN        Public health  Uninsured4 Uninsured4
           NaN    NaN                  NaN                  NaN                  NaN           insurance2                  NaN           insurance3  Uninsured4 Uninsured4
           NaN    NaN                  NaN            Margin of                  NaN            Margin of                  NaN            Margin of         NaN  Margin of
           NaN Number              Percent           error1 (±)              Percent               error1          (±) Percent               error1 (±) Percent error1 (±)
------------------------------------------------------------

--- Raw Table 2 ------------------------------------------------
Shape: (35, 11)
    Unnamed: 0  Total Total.1    Total.2 Total.3              Total.4       Total.5       Total.6     Total.7 Unnamed: 9  Unnamed: 10
           NaN    NaN     NaN        NaN     NaN Any health insurance           NaN           NaN         NaN        NaN          NaN
Characteristic    NaN     NaN        NaN     NaN       Private health Public health Public health  Uninsured4 Uninsured4          NaN
           NaN    NaN     NaN        NaN     NaN           insurance2           NaN    insurance3  insurance3        NaN          NaN
           NaN    NaN     NaN  Margin of     NaN            Margin of           NaN     Margin of         NaN  Margin of          NaN
           NaN Number Percent error1 (±) Percent               error1   (±) Percent        error1 (±) Percent error1 (±)          NaN
------------------------------------------------------------

--- Raw Table 3 ------------------------------------------------
Shape: (29, 11)
    Unnamed: 0  Total              Total.1              Total.2              Total.3              Total.4              Total.5              Total.6     Total.7 Unnamed: 9  Unnamed: 10
           NaN    NaN Any health insurance Any health insurance Any health insurance Any health insurance Any health insurance Any health insurance         NaN        NaN          NaN
Characteristic    NaN                  NaN                  NaN                  NaN       Private health        Public health        Public health  Uninsured4 Uninsured4          NaN
           NaN    NaN                  NaN                  NaN                  NaN           insurance2                  NaN           insurance3  insurance3        NaN          NaN
           NaN    NaN                  NaN            Margin of                  NaN            Margin of                  NaN            Margin of         NaN  Margin of          NaN
           NaN Number              Percent           error1 (±)              Percent               error1          (±) Percent               error1 (±) Percent error1 (±)          NaN
------------------------------------------------------------

--- Raw Table 4 ------------------------------------------------
Shape: (30, 11)
    Unnamed: 0                Total              Total.1              Total.2              Total.3              Total.4              Total.5       Total.6     Total.7    Total.8  Unnamed: 10
           NaN Any health insurance Any health insurance Any health insurance Any health insurance Any health insurance Any health insurance           NaN         NaN        NaN          NaN
           NaN                  NaN                  NaN                  NaN                  NaN       Private health                  NaN Public health  Uninsured4 Uninsured4          NaN
Characteristic                  NaN                  NaN                  NaN                  NaN           insurance2                  NaN    insurance3  insurance3        NaN          NaN
           NaN                  NaN                  NaN            Margin of                  NaN            Margin of                  NaN     Margin of         NaN  Margin of          NaN
           NaN               Number              Percent           error1 (±)              Percent               error1          (±) Percent        error1 (±) Percent error1 (±)          NaN
------------------------------------------------------------
```

It looks like the table 3 matches what we're looking for:

```python
import fused

df = fused.run(
    "fsh_5FVJ7x6aOnF92Zd0zOI5IF",
    pdf_url="https://www2.census.gov/library/publications/2024/demo/p60-284.pdf",
    raw_table_idx=3 # Table 3, one matching our request
)

print(df)
```

Which returns the following DataFrame:

<div style={{textAlign: 'center'}}>
<img src="/img/tutorials/data-science-ai/output_df_from_pdf_parsing.png" alt="Output DataFrame from PDF parsing" style={{width: '100%'}} />
</div>

{/* TODO: You'd need to be in Wb for this to work though, need to change how this is explained */}
You may notice the table has some formatting issues. These can be fixed relatively easily by asking the [AI Assistant](https://www.fused.io/workbench/ai-assistant) to fix them.

### Build it yourself

You can make a copy of the UDF from the [UDF Catalog](https://www.fused.io/workbench/udf/catalog/datalab_pdf_to_json_to_df-50eb6624-16b9-4347-9170-3a462b264357)

You will need to:
- Setup an account on [DataLab](https://www.datalab.to/)
- Get an [API Key](https://www.datalab.to/app/keys)
- Add `datalab` as a secret in the [Preferences](/workbench/preferences/#secrets-management)

And now you get edit this UDF for yourself:

<div style={{textAlign: 'center'}}>
<img src="/img/tutorials/data-science-ai/workbench_pdf_to_df.png" alt="PDF to DataFrame in Workbench" style={{width: '100%'}} />
</div>

## Next Steps

Now that you have a DataFrame you can explore how to build on top:
- Ask AI to [visualize the data](/quickstart/#vibe-coding-a-dashboard)
- See how to turn [any of your UDFs into an API endpoint](/tutorials/engineering-etl/#turn-your-data-into-an-api)
- Let anyone talk to this data [through MCP Servers](/tutorials/Analytics%20&%20Dashboard/let-anyone-talk-to-your-data/)