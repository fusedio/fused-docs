---
id: aggregating-h3-data
title: Aggregate
sidebar_label: Aggregate
sidebar_position: 2
---

# Aggregate

After ingesting a dataset to [H3 hexagons](/tutorials/Geospatial%20with%20Fused/h3-tiling/ingesting-dataset-to-h3) it's possible to [visualize it in Fused](/tutorials/Geospatial%20with%20Fused/h3-tiling/ingesting-dataset-to-h3#reading-and-visualizing-the-h3-dataset) but we can also directly work with the data.

The following page shows how to aggregate data at different resolutions or create derivative layers.

```python showLineNumbers
@fused.udf
def udf(
    bounds: fused.types.Bounds = [-74.556, 40.400, -73.374, 41.029],  # Default to full NYC
):
    path = "s3://fused-asset/hex/copernicus-dem-90m/"
    hex_reader = fused.load("https://github.com/fusedio/udfs/tree/8024b5c/community/joris/Read_H3_dataset/")

    df = hex_reader.read_h3_dataset(path, bounds, res=None)

    return df
```

## Aggregate at lower resolutions

H3 hexagons allow for aggregation at different resolutions. The ingestion process already creates different [overviews](/tutorials/Geospatial%20with%20Fused/h3-tiling/ingesting-dataset-to-h3#overview-resolutions-overview_res) at different H3 resolutions. 

### Numerical data

Example numerical values:
- Temperature
- Elevation
- Income
- Population

Aggregating means:
- Summing values (i.e. how many people live in a H3 cell in total)
- Taking mean / max / min / stddev (i.e. what is the average temperature in a H3 cell)

Implementation:

You can already use the [h3_reader.read_h3_dataset](https://github.com/fusedio/udfs/tree/dd40354/community/joris/Read_H3_dataset/) and specify:
- `res` at a specific resolutions

```python showLineNumbers {4,11}
@fused.udf
def udf(
    bounds: fused.types.Bounds = [-74.556, 40.400, -73.374, 41.029],  # Default to full NYC
    res: int = 4, # Default to H3 resolution 4
):
    path = "s3://fused-asset/hex/copernicus-dem-90m/"
    hex_reader = fused.load("https://github.com/fusedio/udfs/tree/dd40354/community/joris/Read_H3_dataset/")
    df = hex_reader.read_h3_dataset(
        path, 
        bounds, 
        res=res
    )
    return df
```

### Categorical data

Example categorical data:
- Land Use
- Crop Type
- Zone

Aggregating means:
- Counting values (i.e. how many different crop types are there in a H3 cell)
- Taking mode (i.e. what is the most common crop type in a H3 cell)

## Derivative layers 

You can also write your own logic after reading ingested hex data. 

Ex:
- Elevation -> Calculating slope