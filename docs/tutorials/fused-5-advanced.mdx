---
id: 5-advanced-fused
title: 5 Advanced Fused Features
sidebar_label: 5 Advanced Fused Features
sidebar_position: 2
---

# 5 Advanced Fused Features

(After installing `fused`)

### Run 100s of jobs in seconds (`submit`)

```python
import fused 

@fused.udf
def udf(path: str = "https://example.com/sales_data_2023.xlsx"):
   import pandas as pd
   df = pd.read_excel(path)
   filename = path.split("/")[-1].split(".")[0]
   df.to_parquet(f"s3://my-bucket/{filename}.parquet")
   return df

excel_files = [
    "https://example.com/sales_data_2023.xlsx",
    "https://example.com/sales_data_2024.xlsx",
    "https://example.com/sales_data_2025.xlsx",
    ...
]

results = fused.submit(
    udf,
    excel_files,
)
```

### Batch jobs

```python
@fused.udf
def udf(val):
    import pandas as pd
    return pd.DataFrame({'val':[val]})
    
# Running with 5 inputs
job = udf(arg_list=[0,1,2,3,4])
job.run_remote()
```

### Ingest data at scale

```python
# Ingesting Washington DC Census data
job = fused.ingest(
    input="https://www2.census.gov/geo/tiger/TIGER_RD18/LAYER/TRACT/tl_rd22_11_tract.zip",
    output=f"fd://census/partitioned/",
)

job.run_remote()
```

### Preview large files from your laptop

```python
@fused.udf
def udf():
    import pandas as pd
    large_dataset = pd.read_parquet("s3://my-bucket/my-large-dataset.parquet")

    return large_dataset.sample(10)
```

Locally:
```python
sample = fused.run()
```

### Make a Map Tile Server in seconds

```python
@fused.udf
def udf(
   bounds: fused.types.Bounds,
   path: str="s3://fused-asset/data/tiger/state/tl_rd22_us_state 1pct.parquet"
):
   import geopandas as gpd
   
   df = gpd.read_parquet(path)
   df = df.cx[bounds[0]:bounds[2], bounds[1]:bounds[3]]
   df['area'] = df['geometry'].area.round(2)
   return df
```

→ Switch to Tile UDF in Workbench

→ Share as HTTPS tile server:
```
https://staging.fused.io/server/v1/realtime-shared/fsh_73YbgGZWieYpuCbPgLsHTY/run/tiles/{z}/{x}/{y}?dtype_out_vector=parquet
```

