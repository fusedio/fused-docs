---
sidebar_label: fused.api
title: fused.api
toc_max_heading_level: 5
---

## fused.api.whoami

```python
whoami()
```

Renvoie des informations sur l'utilisateur actuellement connecté

---

## fused.api.delete

```python
delete(path: str, max_deletion_depth: int | Literal['unlimited'] = 3) -> bool
```

Supprime les fichiers à l'emplacement spécifié.

**Paramètres :**

- **path** (<code>str</code>) – Répertoire ou fichier à supprimer, comme `fd://my-old-table/`
- **max_deletion_depth** (<code>int | Literal['unlimited']</code>) – Si défini (par défaut à 3), la profondeur maximale à laquelle l'opération va se récursiver.
  Cette option permet d'éviter de supprimer accidentellement plus de données que prévu.
  Passez `"unlimited"` pour illimité.

**Exemples :**

```python
fused.api.delete("fd://bucket-name/deprecated_table/")
```

---

## fused.api.list

```python
list(path: str, *, details: bool = False) -> list[str] | list[ListDetails]
```

Liste les fichiers à l'emplacement spécifié.

**Paramètres :**

- **path** (<code>str</code>) – URL du répertoire parent, comme `fd://bucket-name/`
- **details** (<code>bool</code>) – Si True, renvoie des métadonnées supplémentaires sur chaque enregistrement.

**Renvoie :**

- <code>[list](#fused.api._public_api.list)\[[str](#str)\] | [list](#fused.api._public_api.list)\[[ListDetails](#fused.models.api.ListDetails)\]</code> – Une liste de chemins sous forme d'URLs, ou sous forme d'objets de métadonnées.

**Exemples :**

```python
fused.api.list("fd://bucket-name/")
```

---

## fused.api.get

```python
get(path: str) -> bytes
```

Télécharge le contenu à l'emplacement spécifié en mémoire.

**Paramètres :**

- **path** (<code>str</code>) – URL d'un fichier, comme `fd://bucket-name/file.parquet`

**Renvoie :**

- <code>[bytes](#bytes)</code> – octets du fichier

**Exemples :**

```python
fused.api.get("fd://bucket-name/file.parquet")
```

---

## fused.api.download

```python
download(path: str, local_path: str | Path) -> None
```

Télécharge le contenu à l'emplacement spécifié sur le disque.

**Paramètres :**

- **path** (<code>str</code>) – URL d'un fichier, comme `fd://bucket-name/file.parquet`
- **local_path** (<code>str | Path</code>) – Chemin vers un fichier local.

---

## fused.api.upload

```python
upload(
    local_path: str | Path | bytes | BinaryIO | pd.DataFrame | gpd.GeoDataFrame,
    remote_path: str,
    timeout: float | None = None,
) -> None
```

Télécharge un fichier local vers S3.

**Paramètres :**

- **local_path** (<code>str | Path | bytes | BinaryIO | pd.DataFrame | gpd.GeoDataFrame</code>) – Soit un chemin vers un fichier local (`str`, `Path`), un (Geo)DataFrame
  (qui sera téléchargé en tant que fichier Parquet), ou le contenu à télécharger.
  Toute chaîne sera traitée comme un chemin, si vous souhaitez télécharger le contenu de
  la chaîne, encodez-la d'abord : `s.encode("utf-8")`
- **remote_path** (<code>str</code>) – URL vers laquelle télécharger, comme `fd://new-file.txt`
- **timeout** (<code>float | None</code>) – Délai d'attente optionnel en secondes pour le téléchargement (par défaut à `OPTIONS.request_timeout` si non spécifié).

**Exemples :**

Pour télécharger un fichier json local vers votre bucket S3 géré par Fused :

```py
fused.api.upload("my_file.json", "fd://my_bucket/my_file.json")
```

---

## fused.api.sign_url

```python
sign_url(path: str) -> str
```

Crée une URL signée pour accéder à l'emplacement spécifié.

Cette fonction peut ne pas vérifier si le fichier représenté par le chemin existe.

**Paramètres :**

- **path** (<code>str</code>) – URL d'un fichier, comme `fd://bucket-name/file.parquet`

**Renvoie :**

- <code>[str](#str)</code> – URL HTTPS pour accéder au fichier en utilisant un accès signé.

**Exemples :**

```python
fused.api.sign_url("fd://bucket-name/table_directory/file.parquet")
```

---

## fused.api.sign_url_prefix

```python
sign_url_prefix(path: str) -> dict[str, str]
```

Crée des URLs signées pour accéder à tous les blobs sous l'emplacement spécifié.

**Paramètres :**

- **path** (<code>str</code>) – URL d'un préfixe, comme `fd://bucket-name/some_directory/`

**Renvoie :**

- <code>[dict](#dict)\[[str](#str), [str](#str)\]</code> – Dictionnaire mappant de la clé de stockage de blob à l'URL HTTPS signée.

**Exemples :**

```python
fused.api.sign_url_prefix("fd://bucket-name/table_directory/")
```

---

## fused.api.get_udfs

```python
get_udfs(
    n: int | None = None,
    *,
    skip: int = 0,
    by: Literal["name", "id", "slug"] = "name",
    whose: Literal["self", "public", "community", "team"] = "self"
) -> dict
```

Récupère une liste de UDFs.

**Paramètres :**

- **n** (<code>int | None</code>) – Le nombre total de UDFs à récupérer. Par défaut, tous.
- **skip** (<code>int</code>) – Le nombre de UDFs à ignorer avant de commencer à collecter l'ensemble de résultats. Par défaut, 0.
- **by** (<code>Literal['name', 'id', 'slug']</code>) – L'attribut par lequel trier les UDFs. Peut être "name", "id", ou "slug". Par défaut, "name".
- **whose** (<code>Literal['self', 'public', 'community', 'team']</code>) – Spécifie les UDFs à récupérer. Peut être "self" pour les UDFs propres à l'utilisateur ou "public" pour
  les UDFs disponibles publiquement ou "community" pour tous les UDFs communautaires. Par défaut, "self".

**Renvoie :**

- <code>[dict](#dict)</code> – Une liste de UDFs.

**Exemples :**

Récupérer les UDFs sous le compte utilisateur :

```py
fused.api.get_udfs()
```

---

## fused.api.job_get_logs

```python
job_get_logs(job: CoerceableToJobId, since_ms: int | None = None) -> list[Any]
```

Récupère les journaux pour un job

**Paramètres :**

- **job** (<code>CoerceableToJobId</code>) – l'identifiant d'un job ou un objet `RunResponse`.
- **since_ms** (<code>int | None</code>) – Horodatage, en millisecondes depuis l'époque, pour obtenir les journaux. Par défaut, None pour tous les journaux.

**Renvoie :**

- <code>[list](#fused.api._public_api.list)\[[Any](#typing.Any)\]</code> – Messages de journal pour le job donné.

---

## fused.api.job_print_logs

```python
job_print_logs(
    job: CoerceableToJobId, since_ms: int | None = None, file: IO | None = None
) -> None
```

Récupère et imprime les journaux pour un job

**Paramètres :**

- **job** (<code>CoerceableToJobId</code>) – l'identifiant d'un job ou un objet `RunResponse`.
- **since_ms** (<code>int | None</code>) – Horodatage, en millisecondes depuis l'époque, pour obtenir les journaux. Par défaut, None pour tous les journaux.
- **file** (<code>IO | None</code>) – Où imprimer les journaux. Par défaut, sys.stdout.

**Renvoie :**

- <code>None</code> – None

---

## fused.api.job_tail_logs

```python
job_tail_logs(
    job: CoerceableToJobId,
    refresh_seconds: float = 1,
    sample_logs: bool = True,
    timeout: float | None = None,
)
```

Imprime continuellement les journaux pour un job

**Paramètres :**

- **job** (<code>CoerceableToJobId</code>) – l'identifiant d'un job ou un objet `RunResponse`.
- **refresh_seconds** (<code>float</code>) – à quelle fréquence, en secondes, vérifier les nouveaux journaux. Par défaut, 1.
- **sample_logs** (<code>bool</code>) – si vrai, n'imprime qu'un échantillon de journaux. Par défaut, True.
- **timeout** (<code>float | None</code>) – si pas None, combien de temps continuer à suivre les journaux. Par défaut, None pour indéfini.

---

## fused.api.job_get_status

```python
job_get_status(job: CoerceableToJobId) -> RunResponse
```

Récupère le statut d'un job en cours

**Paramètres :**

- **job** (<code>CoerceableToJobId</code>) – l'identifiant d'un job ou un objet `RunResponse`.

**Renvoie :**

- <code>[RunResponse](#fused.models.internal.job.RunResponse)</code> – Le statut du job donné.

---

## fused.api.job_cancel

```python
job_cancel(job: CoerceableToJobId) -> RunResponse
```

Annule un job existant

**Paramètres :**

- **job** (<code>CoerceableToJobId</code>) – l'identifiant d'un job ou un objet `RunResponse`.

**Renvoie :**

- <code>[RunResponse](#fused.models.internal.job.RunResponse)</code> – Un nouvel objet job.

---

## fused.api.job_get_exec_time

```python
job_get_exec_time(job: CoerceableToJobId) -> timedelta
```

Détermine le temps d'exécution de ce job, en utilisant les journaux.

**Renvoie :**

- <code>[timedelta](#datetime.timedelta)</code> – Temps que le job a pris. Si le job est en cours, le temps entre le premier et le dernier message de journal est renvoyé.

---

## fused.api.job_wait_for_job

```python
job_wait_for_job(
    job: CoerceableToJobId,
    poll_interval_seconds: float = 5,
    timeout: float | None = None,
) -> RunResponse
```

Bloque le noyau Python jusqu'à ce que ce job soit terminé

**Paramètres :**

- **poll_interval_seconds** (<code>float</code>) – À quelle fréquence (en secondes) interroger pour des mises à jour de statut. Par défaut, 5.
- **timeout** (<code>float | None</code>) – La durée en secondes à attendre pour le job. Par défaut, None.

**Lève :**

- <code>[TimeoutError](#TimeoutError)</code> – si l'attente pour le job a expiré.

**Renvoie :**

- <code>[RunResponse](#fused.models.internal.job.RunResponse)</code> – Le statut du job donné.

---

## fused.api.FusedAPI

```python
FusedAPI(
    *,
    base_url: str | None = None,
    set_global_api: bool = True,
    credentials_needed: bool = True
)
```

API pour exécuter des jobs dans le service Fused.

Crée une instance FusedAPI.

**Autres Paramètres :**

- **base_url** (<code>[str](#str) | None</code>) – L'instance Fused à laquelle envoyer des requêtes. Par défaut, `https://www.fused.io/server/v1`.
- **set_global_api** (<code>[bool](#bool)</code>) – Définit ceci comme l'objet API global. Par défaut, True.
- **credentials_needed** (<code>[bool](#bool)</code>) – Si True, tente automatiquement de se connecter. Par défaut, True.

---

### create_udf_access_token

```python
create_udf_access_token(
    udf_email_or_name_or_id: str | None = None,
    /,
    udf_name: str | None = None,
    *,
    udf_email: str | None = None,
    udf_id: str | None = None,
    client_id: str | Ellipsis | None = ...,
    public_read: bool | None = None,
    access_scope: str | None = None,
    cache: bool = True,
    metadata_json: dict[str, Any] | None = None,
    enabled: bool = True,
) -> UdfAccessToken
```

Crée un jeton pour exécuter un UDF. Le jeton permet à quiconque le possédant d'exécuter
le UDF, avec les paramètres de leur choix. Le UDF s'exécutera sous votre environnement.

Le jeton ne permet pas d'exécuter d'autres UDF sur votre compte.

**Paramètres :**

- **udf_email_or_name_or_id** (<code>str | None</code>) – Un ID UDF, une adresse e-mail (pour utilisation avec udf_name), ou un nom de UDF.
- **udf_name** (<code>str | None</code>) – Le nom du UDF pour lequel créer le jeton.

**Autres Paramètres :**

- **udf_email** (<code>[str](#str) | None</code>) – L'e-mail de l'utilisateur possédant le UDF, ou, si udf_name est None, le nom du UDF.
- **udf_id** (<code>[str](#str) | None</code>) – L'ID backend du UDF pour lequel créer le jeton.
- **client_id** (<code>[str](#str) | [Ellipsis](#Ellipsis) | None</code>) – Si spécifié, remplace l'environnement en temps réel sous lequel exécuter le UDF.
- **cache** (<code>[bool](#bool)</code>) – Si True, les tuiles UDF seront mises en cache.
- **metadata_json** (<code>[dict](#dict)\[[str](#str), [Any](#typing.Any)\] | None</code>) – Métadonnées supplémentaires à servir comme partie des métadonnées des tuiles.
- **enable** – Si True, le jeton peut être utilisé.

---

### upload

```python
upload(
    path: str,
    data: bytes | BinaryIO,
    client_id: str | None = None,
    timeout: float | None = None,
) -> None
```

Télécharge un blob binaire vers un emplacement cloud

---

### start_job

```python
start_job(
    config: JobConfig | JobStepConfig,
    *,
    instance_type: WHITELISTED_INSTANCE_TYPES | None = None,
    region: str | None = None,
    disk_size_gb: int | None = None,
    additional_env: Sequence[str] | None = ("FUSED_CREDENTIAL_PROVIDER=ec2",),
    image_name: str | None = None,
    send_status_email: bool | None = None,
    cache_max_age: int | None = None
) -> RunResponse
```

Exécute une opération

**Paramètres :**

- **config** (<code>JobConfig | JobStepConfig</code>) – l'objet de configuration à exécuter dans le job.

**Autres Paramètres :**

- **instance_type** (<code>[WHITELISTED_INSTANCE_TYPES](#fused.models.request.WHITELISTED_INSTANCE_TYPES) | None</code>) – Le type d'instance AWS EC2 à utiliser pour le job. Les chaînes acceptables sont "m5.large", "m5.xlarge", "m5.2xlarge", "m5.4xlarge", "r5.large", "r5.xlarge", "r5.2xlarge", "r5.4xlarge". Par défaut, None.
- **region** (<code>[str](#str) | None</code>) – La région AWS dans laquelle exécuter. Par défaut, None.
- **disk_size_gb** (<code>[int](#int) | None</code>) – La taille du disque à spécifier pour le job. Par défaut, None.
- **additional_env** (<code>[Sequence](#typing.Sequence)\[[str](#str)\] | None</code>) – Toute variable d'environnement supplémentaire à passer dans le job, chacune sous la forme KEY=value. Par défaut, None.
- **image_name** (<code>[str](#str) | None</code>) – Nom d'image personnalisé à exécuter. Par défaut, None pour l'image par défaut.
- **send_status_email** (<code>[bool](#bool) | None</code>) – Si envoyer un e-mail de statut à l'utilisateur lorsque le job est terminé.

---

### get_jobs

```python
get_jobs(
    n: int = 5,
    *,
    skip: int = 0,
    per_request: int = 25,
    max_requests: int | None = 1
) -> Jobs
```

Obtenir l'historique des jobs.

**Paramètres :**

- **n** (<code>int</code>) – Le nombre de jobs à récupérer. Par défaut, 5.

**Autres Paramètres :**

- **skip** (<code>[int](#int)</code>) – Où dans l'historique des jobs commencer. Par défaut, 0, ce qui récupère le job le plus récent.
- **per_request** (<code>[int](#int)</code>) – Nombre de jobs par requête à récupérer. Par défaut, 25.
- **max_requests** (<code>[int](#int) | None</code>) – Nombre maximum de requêtes à effectuer. Peut être None pour récupérer tous les jobs. Par défaut, 1.

**Renvoie :**

- <code>[Jobs](#fused.models.internal.Jobs)</code> – L'historique des jobs.

---

### get_status

```python
get_status(job: CoerceableToJobId) -> RunResponse
```

Récupère le statut d'un job en cours

**Paramètres :**

- **job** (<code>CoerceableToJobId</code>) – l'identifiant d'un job ou un objet `RunResponse`.

**Renvoie :**

- <code>[RunResponse](#fused.models.internal.RunResponse)</code> – Le statut du job donné.

---

### get_logs

```python
get_logs(job: CoerceableToJobId, since_ms: int | None = None) -> list[Any]
```

Récupère les journaux pour un job

**Paramètres :**

- **job** (<code>CoerceableToJobId</code>) – l'identifiant d'un job ou un objet `RunResponse`.
- **since_ms** (<code>int | None</code>) – Horodatage, en millisecondes depuis l'époque, pour obtenir les journaux. Par défaut, None pour tous les journaux.

**Renvoie :**

- <code>[list](#fused.api.api.FusedAPI.list)\[[Any](#typing.Any)\]</code> – Messages de journal pour le job donné.

---

### tail_logs

```python
tail_logs(
    job: CoerceableToJobId,
    refresh_seconds: float = 1,
    sample_logs: bool = False,
    timeout: float | None = None,
)
```

Imprime continuellement les journaux pour un job

**Paramètres :**

- **job** (<code>CoerceableToJobId</code>) – l'identifiant d'un job ou un objet `RunResponse`.
- **refresh_seconds** (<code>float</code>) – à quelle fréquence, en secondes, vérifier les nouveaux journaux. Par défaut, 1.
- **sample_logs** (<code>bool</code>) – si vrai, n'imprime qu'un échantillon de journaux. Par défaut, False.
- **timeout** (<code>float | None</code>) – si pas None, combien de temps continuer à suivre les journaux. Par défaut, None pour indéfini.

---

### wait_for_job

```python
wait_for_job(
    job: CoerceableToJobId,
    poll_interval_seconds: float = 5,
    timeout: float | None = None,
) -> RunResponse
```

Bloque le noyau Python jusqu'à ce que le job donné soit terminé

**Paramètres :**

- **job** (<code>CoerceableToJobId</code>) – l'identifiant d'un job ou un objet `RunResponse`.
- **poll_interval_seconds** (<code>float</code>) – À quelle fréquence (en secondes) interroger pour des mises à jour de statut. Par défaut, 5.
- **timeout** (<code>float | None</code>) – La durée en secondes à attendre pour le job. Par défaut, None.

**Lève :**

- <code>[TimeoutError](#TimeoutError)</code> – si l'attente pour le job a expiré.

**Renvoie :**

- <code>[RunResponse](#fused.models.internal.RunResponse)</code> – Le statut du job donné.

---

### cancel_job

```python
cancel_job(job: CoerceableToJobId) -> RunResponse
```

Annule un job existant

**Paramètres :**

- **job** (<code>CoerceableToJobId</code>) – l'identifiant d'un job ou un objet `RunResponse`.

**Renvoie :**

- <code>[RunResponse](#fused.models.internal.RunResponse)</code> – Un nouvel objet job.

---

### auth_token

```python
auth_token() -> str
```

Renvoie le jeton d'authentification de l'environnement Fused (équipe) de l'utilisateur actuel

---