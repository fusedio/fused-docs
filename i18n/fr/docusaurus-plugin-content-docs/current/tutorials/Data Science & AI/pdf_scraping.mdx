---
slug: pdf-scraping
title: "Rechercher des PDFs, Transformer des Tables en DataFrames"
---

Ce tutoriel vous montrera comment :
- Rechercher des PDFs en ligne directement dans Fused
- Transformer des tables dans des PDFs en DataFrames

<div style={{textAlign: 'center'}}>
![PDF à côté de la table](/img/tutorials/data-science-ai/pdf_next_to_workbench_table.png)
</div>

_Gauche : PDF original. Droite : DataFrame du PDF dans Workbench_

Essayez une [application hébergée](https://www.fused.io/server/v1/realtime-shared/fsh_1IH3QxpoAIEz9qtUChfqtS/run/file) par vous-même :

<iframe 
    style={{
        width: "100%",
        height: "700px",
        border: "1px solid #ccc",
        borderRadius: "8px"
    }}
    src="https://www.fused.io/server/v1/realtime-shared/fsh_1IH3QxpoAIEz9qtUChfqtS/run/file"
    title="Extracteur de Table PDF à CSV"
    allowFullScreen>
</iframe>


## Introduction

Au moment de la rédaction, la recherche dans l'[Assistant IA](https://www.fused.io/workbench/ai-assistant) est toujours sous un drapeau expérimental, donc activez-la :
- Allez dans les [Préférences](/workbench/preferences/)
- Activez "Recherche de Dataset IA"

{/* ![Drapeau de recherche IA dans les Préférences](/img/tutorials/ai_search_flag.png) */}

## Recherche de PDFs

Maintenant que vous avez activé la recherche IA, vous pouvez rechercher des PDFs directement dans Fused :

```text
Rechercher tous les PDFs des données du recensement qui me fourniraient une couverture d'assurance santé et un type par âge. 
Je veux que les données soient disponibles sous forme de tableau.
```

L'Assistant IA fournira une liste de liens vers des PDFs qui se rapprochent le plus de votre demande :

<div style={{textAlign: 'center'}}>
![Assistant IA recherchant des PDFs](/img/tutorials/data-science-ai/pdf_search_ai.png)
</div>

À son stade actuel, nous vous recommandons d'explorer les PDFs par vous-même pour voir lequel correspond le mieux à votre demande.

Le premier lien, pointant vers les données du recensement `.gov` [Census](https://www2.census.gov/library/publications/2024/demo/p60-284.pdf), semble correspondre à notre demande. En l'ouvrant et en allant à l'Annexe, nous trouvons ce que nous cherchons :

<div style={{textAlign: 'center'}}>
![Données de tableau du recensement](/img/tutorials/data-science-ai/census_table_data.png)
</div>

## Transformer des Tables PDF en DataFrames

Ensuite :
- Utilisez l'API [Datalab](https://www.datalab.to/) pour transformer un [PDF en JSON](https://documentation.datalab.to/docs/recipes/table-recognition/table-rec-api-overview)
- Écrivez une UDF qui transforme le JSON en DataFrame

### Utiliser une UDF existante

Nous [avons construit une UDF](https://www.fused.io/workbench/udf/catalog/datalab_pdf_to_json_to_df-50eb6624-16b9-4347-9170-3a462b264357) sur la base de l'API Datalab que vous pouvez utiliser directement :

```python
# dans un notebook
import fused

df = fused.run(
    "fsh_1IH3QxpoAIEz9qtUChfqtS",
    pdf_url="https://www2.census.gov/library/publications/2024/demo/p60-284.pdf",
    raw_table_idx=0
)

print(df)
```

Cela _ne_ renverra _pas_ la table que nous recherchons. C'est une UDF simple qui renvoie chaque table trouvée dans le JSON de DataLab sous forme de DataFrame.

Le message d'impression nous montrera cependant toutes les tables disponibles trouvées :

```

--- Table brute 0 ------------------------------------------------
Shape: (14, 5)
          Unnamed: 0   2022     2022.1   2023     2023.1
       Type de couverture    NaN  Marge de    NaN  Marge de
                 NaN Numéro erreur1 (±) Numéro erreur1 (±)
               Total 330000        130 331700        145
     Tout plan de santé 304000        746 305200        704
Tout plan privé2, 3 216500       1399 216800       1294
------------------------------------------------------------

--- Table brute 1 ------------------------------------------------
Shape: (35, 10)
    Unnamed: 0  Total              Total.1              Total.2              Total.3              Total.4              Total.5              Total.6     Total.7 Unnamed: 9
           NaN    NaN Toute assurance santé Toute assurance santé Toute assurance santé Toute assurance santé Toute assurance santé Toute assurance santé         NaN        NaN
Caractéristique    NaN                  NaN                  NaN                  NaN       Santé privée                  NaN        Santé publique  Non assuré4 Non assuré4
           NaN    NaN                  NaN                  NaN                  NaN           assurance2                  NaN           assurance3  Non assuré4 Non assuré4
           NaN    NaN                  NaN            Marge de                  NaN            Marge de                  NaN            Marge de         NaN  Marge de
           NaN Numéro              Pourcentage           erreur1 (±)              Pourcentage               erreur1          (±) Pourcentage               erreur1 (±) Pourcentage erreur1 (±)
------------------------------------------------------------

--- Table brute 2 ------------------------------------------------
Shape: (35, 11)
    Unnamed: 0  Total Total.1    Total.2 Total.3              Total.4       Total.5       Total.6     Total.7 Unnamed: 9  Unnamed: 10
           NaN    NaN     NaN        NaN     NaN Toute assurance santé           NaN           NaN         NaN        NaN          NaN
Caractéristique    NaN     NaN        NaN     NaN       Santé privée Santé publique Santé publique  Non assuré4 Non assuré4          NaN
           NaN    NaN     NaN        NaN     NaN           assurance2           NaN    assurance3  assurance3        NaN          NaN
           NaN    NaN     NaN  Marge de     NaN            Marge de           NaN     Marge de         NaN  Marge de          NaN
           NaN Numéro Pourcentage erreur1 (±) Pourcentage               erreur1   (±) Pourcentage        erreur1 (±) Pourcentage erreur1 (±)          NaN
------------------------------------------------------------

--- Table brute 3 ------------------------------------------------
Shape: (29, 11)
    Unnamed: 0  Total              Total.1              Total.2              Total.3              Total.4              Total.5              Total.6     Total.7 Unnamed: 9  Unnamed: 10
           NaN    NaN Toute assurance santé Toute assurance santé Toute assurance santé Toute assurance santé Toute assurance santé Toute assurance santé         NaN        NaN          NaN
Caractéristique    NaN                  NaN                  NaN                  NaN       Santé privée        Santé publique        Santé publique  Non assuré4 Non assuré4          NaN
           NaN    NaN                  NaN                  NaN                  NaN           assurance2                  NaN           assurance3  assurance3        NaN          NaN
           NaN    NaN                  NaN            Marge de                  NaN            Marge de                  NaN            Marge de         NaN  Marge de          NaN
           NaN Numéro              Pourcentage           erreur1 (±)              Pourcentage               erreur1          (±) Pourcentage               erreur1 (±) Pourcentage erreur1 (±)          NaN
------------------------------------------------------------

--- Table brute 4 ------------------------------------------------
Shape: (30, 11)
    Unnamed: 0                Total              Total.1              Total.2              Total.3              Total.4              Total.5       Total.6     Total.7    Total.8  Unnamed: 10
           NaN Toute assurance santé Toute assurance santé Toute assurance santé Toute assurance santé Toute assurance santé Toute assurance santé           NaN         NaN        NaN          NaN
           NaN                  NaN                  NaN                  NaN                  NaN       Santé privée                  NaN Santé publique  Non assuré4 Non assuré4          NaN
Caractéristique                  NaN                  NaN                  NaN                  NaN           assurance2                  NaN    assurance3  assurance3        NaN          NaN
           NaN                  NaN                  NaN            Marge de                  NaN            Marge de                  NaN     Marge de         NaN  Marge de          NaN
           NaN               Numéro              Pourcentage           erreur1 (±)              Pourcentage               erreur1          (±) Pourcentage        erreur1 (±) Pourcentage erreur1 (±)          NaN
------------------------------------------------------------
```

Il semble que la table 3 corresponde à ce que nous recherchons :

```python
import fused

df = fused.run(
    "fsh_1IH3QxpoAIEz9qtUChfqtS",
    pdf_url="https://www2.census.gov/library/publications/2024/demo/p60-284.pdf",
    raw_table_idx=3 # Table 3, correspondant à notre demande
)

print(df)
```

Ce qui renvoie le DataFrame suivant :

<div style={{textAlign: 'center'}}>
![DataFrame de sortie de l'analyse PDF](/img/tutorials/data-science-ai/output_df_from_pdf_parsing.png)
</div>

{/* TODO: Vous devez être dans Wb pour que cela fonctionne, il faut changer la façon dont cela est expliqué */}
Vous remarquerez peut-être que la table a quelques problèmes de formatage. Ceux-ci peuvent être corrigés relativement facilement en demandant à l'[Assistant IA](https://www.fused.io/workbench/ai-assistant) de les corriger.

### Construisez-le vous-même

Vous pouvez faire une copie de la UDF depuis le [Catalogue UDF](https://www.fused.io/workbench/udf/catalog/datalab_pdf_to_json_to_df-50eb6624-16b9-4347-9170-3a462b264357)

Vous devrez :
- Créer un compte sur [DataLab](https://www.datalab.to/)
- Obtenir une [clé API](https://www.datalab.to/app/keys)
- Ajouter `datalab` comme secret dans les [Préférences](/workbench/preferences/#secrets-management)

Et maintenant, vous pouvez modifier cette UDF pour vous-même :

<div style={{textAlign: 'center'}}>
![PDF à DataFrame dans Workbench](/img/tutorials/data-science-ai/workbench_pdf_to_df.png)
</div>

## Prochaines étapes

Maintenant que vous avez un DataFrame, vous pouvez explorer comment construire dessus :
- Demandez à l'IA de [visualiser les données](/quickstart/#vibe-coding-a-dashboard)
- Voyez comment transformer [n'importe laquelle de vos UDFs en un point de terminaison API](/tutorials/engineering-etl/#turn-your-data-into-an-api)
- Permettez à quiconque de parler à ces données [via les serveurs MCP](/tutorials/Analytics%20&%20Dashboard/let-anyone-talk-to-your-data/)