---
id: app-map
title: Ajouter une carte √† votre application
tags: [app]
sidebar_position: 2
---

Pour de nombreuses applications g√©ospatiales, vous souhaiterez ajouter une carte √† votre application Fused, surtout si votre UDF renvoie un [Map `Tile`](/tutorials/Geospatial%20with%20Fused/filetile/#tile).

Cette section montre quelques exemples de la fa√ßon dont vous pouvez le faire. Bien que nous recommandions d'utiliser [`pydeck`](/workbench/app-builder/app-map/#pydeck) (l'impl√©mentation Python de [deck.gl](https://deck.gl/)) pour sa polyvalence, vous pouvez utiliser d'autres options comme [`folium`](/workbench/app-builder/app-map/#folium)

:::note

    Notez que vous devez installer des d√©pendances avec `micropip` √† l'int√©rieur de votre application Fused. Plus d'informations [ici](/workbench/app-builder/app-overview/#dependencies).
:::


## Pydeck

Cr√©ez un [pydeck GeoJsonLayer](https://deckgl.readthedocs.io/en/latest/layer.html) qui trace un simple GeoDataFrame.

Vous pouvez trouver cette application [juste ici](https://www.fused.io/workbench/apps#app/s/i/fa_3qtkNGx3cLhrvd9h9FjDRz) et la tester par vous-m√™me !

Voici √† quoi cela ressemblerait :

![ImgStdout](/img/app-builder/app-builder-simple-pydeck.png)

<div style={{ marginTop: "50px" }}></div>

```python showLineNumbers
# installing pydeck & geopandas inside Fused app
import micropip
await micropip.install(['pydeck', 'geopandas'])

import fused
import geopandas as gpd
import pydeck as pdk
import streamlit as st

st.write("# Bonjour le monde ! üëã")
st.write("Voici un exemple simple d'une application Fused tra√ßant les stations de m√©tro de NYC")

DATASET = 'https://raw.githubusercontent.com/python-visualization/folium-example-data/main/subway_stations.geojson'
gdf = gpd.read_file(DATASET)
# Nous tamponnons les points pour les rendre plus visibles sur notre carte
gdf.geometry = gdf.geometry.buffer(0.001)

# Cr√©ation d'un √©l√©ment pydeck vide
deck = st.empty()

# Initiation de l'√©l√©ment pydeck avec une vue sur NYC
view_state = pdk.ViewState(
    latitude=40.73,
    longitude=-73.96,
    zoom=10,
    pitch=0
)

# Cr√©ation d'une couche GeoJSON avec notre GeoDataFrame
geojson_layer = pdk.Layer(
    'GeoJsonLayer',
    gdf,
)

updated_deck = pdk.Deck(
    layers=[geojson_layer],
    initial_view_state=view_state,
    map_style='mapbox://styles/mapbox/light-v9'
)

deck.pydeck_chart(updated_deck)
```

Lisez-en plus sur la fa√ßon d'utiliser Pydeck dans leur [documentation officielle](https://deckgl.readthedocs.io/en/latest/index.html).

:::note
    Cet exemple montre comment tracer un `GeoDataFrame` directement, mais vous pourriez le remplacer par un UDF qui renvoie √©galement un `GeoDataFrame` :

    ```python showLineNumbers
    # DATASET = 'https://raw.githubusercontent.com/python-visualization/folium-example-data/main/subway_stations.geojson'
    # gdf = gpd.read_file(DATASET)
    # highlight-next-line
    gdf = fused.run("YOUR_UDF_RETURNING_A_GDF")
    ```

    Lisez-en plus sur `fused.run` dans la [section d√©di√©e](/core-concepts/run-udfs/run-small-udfs/#fusedrun)
:::

## Folium

Cr√©ez un [streamlit-folium](https://folium.streamlit.app/) `TileLayer` qui appelle un point de terminaison UDF HTTPS.

```python showLineNumbers
import folium
from streamlit_folium import st_folium

m = folium.Map(location=[22.5, -115], zoom_start=4)
url_raster = 'https://www.fused.io/server/v1/realtime-shared/fsh_3QYQiMYzgyV18rUBdrOEpO/run/tiles/{z}/{x}/{y}?format=png'
folium.raster_layers.TileLayer(tiles=url_raster, attr='fu', interactive=True,).add_to(m)
st_folium(m)
```