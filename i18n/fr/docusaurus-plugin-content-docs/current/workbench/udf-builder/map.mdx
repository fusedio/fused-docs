---
id: map
title: Carte
tags: [carte]
sidebar_position: 5
---

En tant que développeurs modifient les UDF dans l'[Éditeur de code](/workbench/udf-builder/code-editor/) et explorent les données, ils peuvent recevoir un retour visuel immédiat sur la façon dont les transformations du code affectent les données.

## Données géospatiales

Fused rendra les sorties UDF `gpd.GeoDataFrame`, `gpd.GeoSeries` et `shapely geometry` en tant que géométries sur la carte si leur CRS est `EPSG:4326`. Si le CRS diffère, Fused fera de son mieux pour projeter et rendre les géométries correctement.

Pour rendre des objets de tableau (raster) sur la carte, ils doivent être `uint8` et définir leur étendue spatiale. Des objets comme `xarray.DataArray` contiennent déjà des métadonnées spatiales. L'étendue spatiale des tableaux sans métadonnées spatiales, comme `numpy.ndarray`, peut être spécifiée avec un objet de géométrie ou des limites de tableau sous la forme `[xmin, ymin, xmax, ymax]`. Si les limites ne sont pas présentes, elles sont par défaut `(-180, -90, 180, 90)`.

```python showLineNumbers
return np.array([[…], […]]), [xmin, ymin, xmax, ymax]
```

Pour les UDF qui retournent [tuiles de carte](/tutorials/Geospatial%20with%20Fused/filetile/#tile), Fused exécute l'UDF uniquement pour les Tuiles dans le champ de vision. Cela permet une analyse efficace sur une fraction d'un ensemble de données.

<ReactPlayer playsinline={true} className="video__player" loop={true} playing={false} muted={true} controls height="100%" url="https://fused-magic.s3.us-west-2.amazonaws.com/workbench-walkthrough-videos/docs_rewrite/map_overture2.mp4" width="100%" />

### Contrôles de la carte

La carte peut être déplacée en faisant glisser le champ de vision, zoomée avant et arrière, et tournée avec `Cmd` + `Click` + glisser sur MacOS (`Ctrl` + `Click` + glisser sur Windows / Linux)

Le haut de la carte dispose de contrôles pour interagir avec le champ de vision. Ceux-ci incluent une barre de recherche d'adresse, un sélecteur de [carte de base](https://docs.mapbox.com/api/maps/styles/), un bouton plein écran, une icône de visualisation des données, et un menu à trois points fournissant un accès à des options de carte supplémentaires.

Vous pouvez changer la carte de base en la définissant dans les paramètres de style de la carte, situés en haut à droite de la carte de l'éditeur UDF. Actuellement, les cartes de base claires, sombres, satellite et vierges sont prises en charge.

<ReactPlayer playsinline={true} className="video__player" loop={true} playing={false} muted={true} controls height="100%" url="https://fused-magic.s3.us-west-2.amazonaws.com/workbench-walkthrough-videos/docs_rewrite/mapcontrols_edit2.mp4" width="100%" />

## Débogage

Cliquer sur une fonctionnalité rendue entre en mode débogage. Pour sortir, appuyez sur `Échap` ou cliquez sur le `X` dans l'en-tête de l'info-bulle de la carte."

Lorsque les données se rendent avec succès sur la carte, cliquer ou survoler montre les attributs pour les pixels ou géométries sélectionnés. Lorsque les données ne se rendent pas, cliquer sur des tuiles erronées affiche un code d'erreur, et les détails complets de l'erreur peuvent être copiés au format JSON. Des informations de débogage supplémentaires peuvent être trouvées dans le panneau [Runtime](/workbench/udf-builder/runtime/).

<ReactPlayer playsinline={true} className="video__player" loop={true} playing={false} muted={true} controls height="100%" url="https://fused-magic.s3.us-west-2.amazonaws.com/workbench-walkthrough-videos/docs_rewrite/debugclick5.mp4" width="100%" />